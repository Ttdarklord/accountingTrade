var dr=s=>{throw TypeError(s)};var Ss=(s,t,r)=>t.has(s)||dr("Cannot "+r);var c=(s,t,r)=>(Ss(s,t,"read from private field"),r?r.call(s):t.get(s)),L=(s,t,r)=>t.has(s)?dr("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,r),O=(s,t,r,a)=>(Ss(s,t,"write to private field"),a?a.call(s,r):t.set(s,r),r),B=(s,t,r)=>(Ss(s,t,"access private method"),r);var ts=(s,t,r,a)=>({set _(n){O(s,t,n,r)},get _(){return c(s,t,a)}});import{r as S,a as Ua,N as ur,L as Cs,R as Ia,b as Me,c as Ba,B as Qa}from"./vendor-C1nvLWEz.js";import{E as za,a as Ha}from"./pdf-CMic3gaH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var Gr={exports:{}},xs={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ka=S,Va=Symbol.for("react.element"),Wa=Symbol.for("react.fragment"),Ja=Object.prototype.hasOwnProperty,Ga=Ka.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ya={key:!0,ref:!0,__self:!0,__source:!0};function Yr(s,t,r){var a,n={},l=null,i=null;r!==void 0&&(l=""+r),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(i=t.ref);for(a in t)Ja.call(t,a)&&!Ya.hasOwnProperty(a)&&(n[a]=t[a]);if(s&&s.defaultProps)for(a in t=s.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:Va,type:s,key:l,ref:i,props:n,_owner:Ga.current}}xs.Fragment=Wa;xs.jsx=Yr;xs.jsxs=Yr;Gr.exports=xs;var e=Gr.exports,Ds={},hr=Ua;Ds.createRoot=hr.createRoot,Ds.hydrateRoot=hr.hydrateRoot;var qt=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ft=typeof window>"u"||"Deno"in globalThis;function he(){}function Xa(s,t){return typeof s=="function"?s(t):s}function Rs(s){return typeof s=="number"&&s>=0&&s!==1/0}function Xr(s,t){return Math.max(s+(t||0)-Date.now(),0)}function et(s,t){return typeof s=="function"?s(t):s}function we(s,t){return typeof s=="function"?s(t):s}function mr(s,t){const{type:r="all",exact:a,fetchStatus:n,predicate:l,queryKey:i,stale:o}=s;if(i){if(a){if(t.queryHash!==Zs(i,t.options))return!1}else if(!zt(t.queryKey,i))return!1}if(r!=="all"){const h=t.isActive();if(r==="active"&&!h||r==="inactive"&&h)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||n&&n!==t.state.fetchStatus||l&&!l(t))}function xr(s,t){const{exact:r,status:a,predicate:n,mutationKey:l}=s;if(l){if(!t.options.mutationKey)return!1;if(r){if(yt(t.options.mutationKey)!==yt(l))return!1}else if(!zt(t.options.mutationKey,l))return!1}return!(a&&t.state.status!==a||n&&!n(t))}function Zs(s,t){return((t==null?void 0:t.queryKeyHashFn)||yt)(s)}function yt(s){return JSON.stringify(s,(t,r)=>Os(r)?Object.keys(r).sort().reduce((a,n)=>(a[n]=r[n],a),{}):r)}function zt(s,t){return s===t?!0:typeof s!=typeof t?!1:s&&t&&typeof s=="object"&&typeof t=="object"?Object.keys(t).every(r=>zt(s[r],t[r])):!1}function Zr(s,t){if(s===t)return s;const r=pr(s)&&pr(t);if(r||Os(s)&&Os(t)){const a=r?s:Object.keys(s),n=a.length,l=r?t:Object.keys(t),i=l.length,o=r?[]:{},h=new Set(a);let m=0;for(let p=0;p<i;p++){const y=r?p:l[p];(!r&&h.has(y)||r)&&s[y]===void 0&&t[y]===void 0?(o[y]=void 0,m++):(o[y]=Zr(s[y],t[y]),o[y]===s[y]&&s[y]!==void 0&&m++)}return n===i&&m===n?s:o}return t}function cs(s,t){if(!t||Object.keys(s).length!==Object.keys(t).length)return!1;for(const r in s)if(s[r]!==t[r])return!1;return!0}function pr(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function Os(s){if(!fr(s))return!1;const t=s.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!fr(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function fr(s){return Object.prototype.toString.call(s)==="[object Object]"}function Za(s){return new Promise(t=>{setTimeout(t,s)})}function Ps(s,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(s,t):r.structuralSharing!==!1?Zr(s,t):t}function en(s,t,r=0){const a=[...s,t];return r&&a.length>r?a.slice(1):a}function tn(s,t,r=0){const a=[t,...s];return r&&a.length>r?a.slice(0,-1):a}var er=Symbol();function ea(s,t){return!s.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!s.queryFn||s.queryFn===er?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}function ta(s,t){return typeof s=="function"?s(...t):!!s}var it,ze,kt,Ur,sn=(Ur=class extends qt{constructor(){super();L(this,it);L(this,ze);L(this,kt);O(this,kt,t=>{if(!ft&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){c(this,ze)||this.setEventListener(c(this,kt))}onUnsubscribe(){var t;this.hasListeners()||((t=c(this,ze))==null||t.call(this),O(this,ze,void 0))}setEventListener(t){var r;O(this,kt,t),(r=c(this,ze))==null||r.call(this),O(this,ze,t(a=>{typeof a=="boolean"?this.setFocused(a):this.onFocus()}))}setFocused(t){c(this,it)!==t&&(O(this,it,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof c(this,it)=="boolean"?c(this,it):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},it=new WeakMap,ze=new WeakMap,kt=new WeakMap,Ur),tr=new sn,_t,He,At,Ir,rn=(Ir=class extends qt{constructor(){super();L(this,_t,!0);L(this,He);L(this,At);O(this,At,t=>{if(!ft&&window.addEventListener){const r=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",a,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",a)}}})}onSubscribe(){c(this,He)||this.setEventListener(c(this,At))}onUnsubscribe(){var t;this.hasListeners()||((t=c(this,He))==null||t.call(this),O(this,He,void 0))}setEventListener(t){var r;O(this,At,t),(r=c(this,He))==null||r.call(this),O(this,He,t(this.setOnline.bind(this)))}setOnline(t){c(this,_t)!==t&&(O(this,_t,t),this.listeners.forEach(a=>{a(t)}))}isOnline(){return c(this,_t)}},_t=new WeakMap,He=new WeakMap,At=new WeakMap,Ir),os=new rn;function Fs(){let s,t;const r=new Promise((n,l)=>{s=n,t=l});r.status="pending",r.catch(()=>{});function a(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{a({status:"fulfilled",value:n}),s(n)},r.reject=n=>{a({status:"rejected",reason:n}),t(n)},r}function an(s){return Math.min(1e3*2**s,3e4)}function sa(s){return(s??"online")==="online"?os.isOnline():!0}var ra=class extends Error{constructor(s){super("CancelledError"),this.revert=s==null?void 0:s.revert,this.silent=s==null?void 0:s.silent}};function ks(s){return s instanceof ra}function aa(s){let t=!1,r=0,a=!1,n;const l=Fs(),i=N=>{var x;a||(b(new ra(N)),(x=s.abort)==null||x.call(s))},o=()=>{t=!0},h=()=>{t=!1},m=()=>tr.isFocused()&&(s.networkMode==="always"||os.isOnline())&&s.canRun(),p=()=>sa(s.networkMode)&&s.canRun(),y=N=>{var x;a||(a=!0,(x=s.onSuccess)==null||x.call(s,N),n==null||n(),l.resolve(N))},b=N=>{var x;a||(a=!0,(x=s.onError)==null||x.call(s,N),n==null||n(),l.reject(N))},C=()=>new Promise(N=>{var x;n=k=>{(a||m())&&N(k)},(x=s.onPause)==null||x.call(s)}).then(()=>{var N;n=void 0,a||(N=s.onContinue)==null||N.call(s)}),d=()=>{if(a)return;let N;const x=r===0?s.initialPromise:void 0;try{N=x??s.fn()}catch(k){N=Promise.reject(k)}Promise.resolve(N).then(y).catch(k=>{var P;if(a)return;const _=s.retry??(ft?0:3),v=s.retryDelay??an,f=typeof v=="function"?v(r,k):v,D=_===!0||typeof _=="number"&&r<_||typeof _=="function"&&_(r,k);if(t||!D){b(k);return}r++,(P=s.onFail)==null||P.call(s,r,k),Za(f).then(()=>m()?void 0:C()).then(()=>{t?b(k):d()})})};return{promise:l,cancel:i,continue:()=>(n==null||n(),l),cancelRetry:o,continueRetry:h,canStart:p,start:()=>(p()?d():C().then(d),l)}}var nn=s=>setTimeout(s,0);function ln(){let s=[],t=0,r=o=>{o()},a=o=>{o()},n=nn;const l=o=>{t?s.push(o):n(()=>{r(o)})},i=()=>{const o=s;s=[],o.length&&n(()=>{a(()=>{o.forEach(h=>{r(h)})})})};return{batch:o=>{let h;t++;try{h=o()}finally{t--,t||i()}return h},batchCalls:o=>(...h)=>{l(()=>{o(...h)})},schedule:l,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{a=o},setScheduler:o=>{n=o}}}var re=ln(),lt,Br,na=(Br=class{constructor(){L(this,lt)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Rs(this.gcTime)&&O(this,lt,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(ft?1/0:5*60*1e3))}clearGcTimeout(){c(this,lt)&&(clearTimeout(c(this,lt)),O(this,lt,void 0))}},lt=new WeakMap,Br),Et,ct,ve,ot,ce,Vt,dt,Ce,qe,Qr,cn=(Qr=class extends na{constructor(t){super();L(this,Ce);L(this,Et);L(this,ct);L(this,ve);L(this,ot);L(this,ce);L(this,Vt);L(this,dt);O(this,dt,!1),O(this,Vt,t.defaultOptions),this.setOptions(t.options),this.observers=[],O(this,ot,t.client),O(this,ve,c(this,ot).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,O(this,Et,on(this.options)),this.state=t.state??c(this,Et),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=c(this,ce))==null?void 0:t.promise}setOptions(t){this.options={...c(this,Vt),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&c(this,ve).remove(this)}setData(t,r){const a=Ps(this.state.data,t,this.options);return B(this,Ce,qe).call(this,{data:a,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),a}setState(t,r){B(this,Ce,qe).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var a,n;const r=(a=c(this,ce))==null?void 0:a.promise;return(n=c(this,ce))==null||n.cancel(t),r?r.then(he).catch(he):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(c(this,Et))}isActive(){return this.observers.some(t=>we(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===er||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>et(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Xr(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(a=>a.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=c(this,ce))==null||r.continue()}onOnline(){var r;const t=this.observers.find(a=>a.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=c(this,ce))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),c(this,ve).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(c(this,ce)&&(c(this,dt)?c(this,ce).cancel({revert:!0}):c(this,ce).cancelRetry()),this.scheduleGc()),c(this,ve).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||B(this,Ce,qe).call(this,{type:"invalidate"})}fetch(t,r){var m,p,y;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(c(this,ce))return c(this,ce).continueRetry(),c(this,ce).promise}if(t&&this.setOptions(t),!this.options.queryFn){const b=this.observers.find(C=>C.options.queryFn);b&&this.setOptions(b.options)}const a=new AbortController,n=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(O(this,dt,!0),a.signal)})},l=()=>{const b=ea(this.options,r),d=(()=>{const N={client:c(this,ot),queryKey:this.queryKey,meta:this.meta};return n(N),N})();return O(this,dt,!1),this.options.persister?this.options.persister(b,d,this):b(d)},o=(()=>{const b={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:c(this,ot),state:this.state,fetchFn:l};return n(b),b})();(m=this.options.behavior)==null||m.onFetch(o,this),O(this,ct,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=o.fetchOptions)==null?void 0:p.meta))&&B(this,Ce,qe).call(this,{type:"fetch",meta:(y=o.fetchOptions)==null?void 0:y.meta});const h=b=>{var C,d,N,x;ks(b)&&b.silent||B(this,Ce,qe).call(this,{type:"error",error:b}),ks(b)||((d=(C=c(this,ve).config).onError)==null||d.call(C,b,this),(x=(N=c(this,ve).config).onSettled)==null||x.call(N,this.state.data,b,this)),this.scheduleGc()};return O(this,ce,aa({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,abort:a.abort.bind(a),onSuccess:b=>{var C,d,N,x;if(b===void 0){h(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(b)}catch(k){h(k);return}(d=(C=c(this,ve).config).onSuccess)==null||d.call(C,b,this),(x=(N=c(this,ve).config).onSettled)==null||x.call(N,b,this.state.error,this),this.scheduleGc()},onError:h,onFail:(b,C)=>{B(this,Ce,qe).call(this,{type:"failed",failureCount:b,error:C})},onPause:()=>{B(this,Ce,qe).call(this,{type:"pause"})},onContinue:()=>{B(this,Ce,qe).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),c(this,ce).start()}},Et=new WeakMap,ct=new WeakMap,ve=new WeakMap,ot=new WeakMap,ce=new WeakMap,Vt=new WeakMap,dt=new WeakMap,Ce=new WeakSet,qe=function(t){const r=a=>{switch(t.type){case"failed":return{...a,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...a,fetchStatus:"paused"};case"continue":return{...a,fetchStatus:"fetching"};case"fetch":return{...a,...ia(a.data,this.options),fetchMeta:t.meta??null};case"success":return O(this,ct,void 0),{...a,data:t.data,dataUpdateCount:a.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=t.error;return ks(n)&&n.revert&&c(this,ct)?{...c(this,ct),fetchStatus:"idle"}:{...a,error:n,errorUpdateCount:a.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:a.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...a,isInvalidated:!0};case"setState":return{...a,...t.state}}};this.state=r(this.state),re.batch(()=>{this.observers.forEach(a=>{a.onQueryUpdate()}),c(this,ve).notify({query:this,type:"updated",action:t})})},Qr);function ia(s,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:sa(t.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function on(s){const t=typeof s.initialData=="function"?s.initialData():s.initialData,r=t!==void 0,a=r?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var De,zr,dn=(zr=class extends qt{constructor(t={}){super();L(this,De);this.config=t,O(this,De,new Map)}build(t,r,a){const n=r.queryKey,l=r.queryHash??Zs(n,r);let i=this.get(l);return i||(i=new cn({client:t,queryKey:n,queryHash:l,options:t.defaultQueryOptions(r),state:a,defaultOptions:t.getQueryDefaults(n)}),this.add(i)),i}add(t){c(this,De).has(t.queryHash)||(c(this,De).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=c(this,De).get(t.queryHash);r&&(t.destroy(),r===t&&c(this,De).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){re.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return c(this,De).get(t)}getAll(){return[...c(this,De).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(a=>mr(r,a))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(a=>mr(t,a)):r}notify(t){re.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){re.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){re.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},De=new WeakMap,zr),Re,de,ut,Oe,Qe,Hr,un=(Hr=class extends na{constructor(t){super();L(this,Oe);L(this,Re);L(this,de);L(this,ut);this.mutationId=t.mutationId,O(this,de,t.mutationCache),O(this,Re,[]),this.state=t.state||la(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){c(this,Re).includes(t)||(c(this,Re).push(t),this.clearGcTimeout(),c(this,de).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){O(this,Re,c(this,Re).filter(r=>r!==t)),this.scheduleGc(),c(this,de).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){c(this,Re).length||(this.state.status==="pending"?this.scheduleGc():c(this,de).remove(this))}continue(){var t;return((t=c(this,ut))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,i,o,h,m,p,y,b,C,d,N,x,k,_,v,f,D,P,z,F;const r=()=>{B(this,Oe,Qe).call(this,{type:"continue"})};O(this,ut,aa({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(M,K)=>{B(this,Oe,Qe).call(this,{type:"failed",failureCount:M,error:K})},onPause:()=>{B(this,Oe,Qe).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>c(this,de).canRun(this)}));const a=this.state.status==="pending",n=!c(this,ut).canStart();try{if(a)r();else{B(this,Oe,Qe).call(this,{type:"pending",variables:t,isPaused:n}),await((i=(l=c(this,de).config).onMutate)==null?void 0:i.call(l,t,this));const K=await((h=(o=this.options).onMutate)==null?void 0:h.call(o,t));K!==this.state.context&&B(this,Oe,Qe).call(this,{type:"pending",context:K,variables:t,isPaused:n})}const M=await c(this,ut).start();return await((p=(m=c(this,de).config).onSuccess)==null?void 0:p.call(m,M,t,this.state.context,this)),await((b=(y=this.options).onSuccess)==null?void 0:b.call(y,M,t,this.state.context)),await((d=(C=c(this,de).config).onSettled)==null?void 0:d.call(C,M,null,this.state.variables,this.state.context,this)),await((x=(N=this.options).onSettled)==null?void 0:x.call(N,M,null,t,this.state.context)),B(this,Oe,Qe).call(this,{type:"success",data:M}),M}catch(M){try{throw await((_=(k=c(this,de).config).onError)==null?void 0:_.call(k,M,t,this.state.context,this)),await((f=(v=this.options).onError)==null?void 0:f.call(v,M,t,this.state.context)),await((P=(D=c(this,de).config).onSettled)==null?void 0:P.call(D,void 0,M,this.state.variables,this.state.context,this)),await((F=(z=this.options).onSettled)==null?void 0:F.call(z,void 0,M,t,this.state.context)),M}finally{B(this,Oe,Qe).call(this,{type:"error",error:M})}}finally{c(this,de).runNext(this)}}},Re=new WeakMap,de=new WeakMap,ut=new WeakMap,Oe=new WeakSet,Qe=function(t){const r=a=>{switch(t.type){case"failed":return{...a,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...a,isPaused:!0};case"continue":return{...a,isPaused:!1};case"pending":return{...a,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...a,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...a,data:void 0,error:t.error,failureCount:a.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),re.batch(()=>{c(this,Re).forEach(a=>{a.onMutationUpdate(t)}),c(this,de).notify({mutation:this,type:"updated",action:t})})},Hr);function la(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var $e,ke,Wt,Kr,hn=(Kr=class extends qt{constructor(t={}){super();L(this,$e);L(this,ke);L(this,Wt);this.config=t,O(this,$e,new Set),O(this,ke,new Map),O(this,Wt,0)}build(t,r,a){const n=new un({mutationCache:this,mutationId:++ts(this,Wt)._,options:t.defaultMutationOptions(r),state:a});return this.add(n),n}add(t){c(this,$e).add(t);const r=ss(t);if(typeof r=="string"){const a=c(this,ke).get(r);a?a.push(t):c(this,ke).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(c(this,$e).delete(t)){const r=ss(t);if(typeof r=="string"){const a=c(this,ke).get(r);if(a)if(a.length>1){const n=a.indexOf(t);n!==-1&&a.splice(n,1)}else a[0]===t&&c(this,ke).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=ss(t);if(typeof r=="string"){const a=c(this,ke).get(r),n=a==null?void 0:a.find(l=>l.state.status==="pending");return!n||n===t}else return!0}runNext(t){var a;const r=ss(t);if(typeof r=="string"){const n=(a=c(this,ke).get(r))==null?void 0:a.find(l=>l!==t&&l.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}else return Promise.resolve()}clear(){re.batch(()=>{c(this,$e).forEach(t=>{this.notify({type:"removed",mutation:t})}),c(this,$e).clear(),c(this,ke).clear()})}getAll(){return Array.from(c(this,$e))}find(t){const r={exact:!0,...t};return this.getAll().find(a=>xr(r,a))}findAll(t={}){return this.getAll().filter(r=>xr(t,r))}notify(t){re.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return re.batch(()=>Promise.all(t.map(r=>r.continue().catch(he))))}},$e=new WeakMap,ke=new WeakMap,Wt=new WeakMap,Kr);function ss(s){var t;return(t=s.options.scope)==null?void 0:t.id}function yr(s){return{onFetch:(t,r)=>{var p,y,b,C,d;const a=t.options,n=(b=(y=(p=t.fetchOptions)==null?void 0:p.meta)==null?void 0:y.fetchMore)==null?void 0:b.direction,l=((C=t.state.data)==null?void 0:C.pages)||[],i=((d=t.state.data)==null?void 0:d.pageParams)||[];let o={pages:[],pageParams:[]},h=0;const m=async()=>{let N=!1;const x=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?N=!0:t.signal.addEventListener("abort",()=>{N=!0}),t.signal)})},k=ea(t.options,t.fetchOptions),_=async(v,f,D)=>{if(N)return Promise.reject();if(f==null&&v.pages.length)return Promise.resolve(v);const z=(()=>{const V={client:t.client,queryKey:t.queryKey,pageParam:f,direction:D?"backward":"forward",meta:t.options.meta};return x(V),V})(),F=await k(z),{maxPages:M}=t.options,K=D?tn:en;return{pages:K(v.pages,F,M),pageParams:K(v.pageParams,f,M)}};if(n&&l.length){const v=n==="backward",f=v?mn:gr,D={pages:l,pageParams:i},P=f(a,D);o=await _(D,P,v)}else{const v=s??l.length;do{const f=h===0?i[0]??a.initialPageParam:gr(a,o);if(h>0&&f==null)break;o=await _(o,f),h++}while(h<v)}return o};t.options.persister?t.fetchFn=()=>{var N,x;return(x=(N=t.options).persister)==null?void 0:x.call(N,m,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=m}}}function gr(s,{pages:t,pageParams:r}){const a=t.length-1;return t.length>0?s.getNextPageParam(t[a],t,r[a],r):void 0}function mn(s,{pages:t,pageParams:r}){var a;return t.length>0?(a=s.getPreviousPageParam)==null?void 0:a.call(s,t[0],t,r[0],r):void 0}var te,Ke,Ve,Tt,Dt,We,Rt,Ot,Vr,xn=(Vr=class{constructor(s={}){L(this,te);L(this,Ke);L(this,Ve);L(this,Tt);L(this,Dt);L(this,We);L(this,Rt);L(this,Ot);O(this,te,s.queryCache||new dn),O(this,Ke,s.mutationCache||new hn),O(this,Ve,s.defaultOptions||{}),O(this,Tt,new Map),O(this,Dt,new Map),O(this,We,0)}mount(){ts(this,We)._++,c(this,We)===1&&(O(this,Rt,tr.subscribe(async s=>{s&&(await this.resumePausedMutations(),c(this,te).onFocus())})),O(this,Ot,os.subscribe(async s=>{s&&(await this.resumePausedMutations(),c(this,te).onOnline())})))}unmount(){var s,t;ts(this,We)._--,c(this,We)===0&&((s=c(this,Rt))==null||s.call(this),O(this,Rt,void 0),(t=c(this,Ot))==null||t.call(this),O(this,Ot,void 0))}isFetching(s){return c(this,te).findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return c(this,Ke).findAll({...s,status:"pending"}).length}getQueryData(s){var r;const t=this.defaultQueryOptions({queryKey:s});return(r=c(this,te).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(s){const t=this.defaultQueryOptions(s),r=c(this,te).build(this,t),a=r.state.data;return a===void 0?this.fetchQuery(s):(s.revalidateIfStale&&r.isStaleByTime(et(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(s){return c(this,te).findAll(s).map(({queryKey:t,state:r})=>{const a=r.data;return[t,a]})}setQueryData(s,t,r){const a=this.defaultQueryOptions({queryKey:s}),n=c(this,te).get(a.queryHash),l=n==null?void 0:n.state.data,i=Xa(t,l);if(i!==void 0)return c(this,te).build(this,a).setData(i,{...r,manual:!0})}setQueriesData(s,t,r){return re.batch(()=>c(this,te).findAll(s).map(({queryKey:a})=>[a,this.setQueryData(a,t,r)]))}getQueryState(s){var r;const t=this.defaultQueryOptions({queryKey:s});return(r=c(this,te).get(t.queryHash))==null?void 0:r.state}removeQueries(s){const t=c(this,te);re.batch(()=>{t.findAll(s).forEach(r=>{t.remove(r)})})}resetQueries(s,t){const r=c(this,te);return re.batch(()=>(r.findAll(s).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...s},t)))}cancelQueries(s,t={}){const r={revert:!0,...t},a=re.batch(()=>c(this,te).findAll(s).map(n=>n.cancel(r)));return Promise.all(a).then(he).catch(he)}invalidateQueries(s,t={}){return re.batch(()=>(c(this,te).findAll(s).forEach(r=>{r.invalidate()}),(s==null?void 0:s.refetchType)==="none"?Promise.resolve():this.refetchQueries({...s,type:(s==null?void 0:s.refetchType)??(s==null?void 0:s.type)??"active"},t)))}refetchQueries(s,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},a=re.batch(()=>c(this,te).findAll(s).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let l=n.fetch(void 0,r);return r.throwOnError||(l=l.catch(he)),n.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(a).then(he)}fetchQuery(s){const t=this.defaultQueryOptions(s);t.retry===void 0&&(t.retry=!1);const r=c(this,te).build(this,t);return r.isStaleByTime(et(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(he).catch(he)}fetchInfiniteQuery(s){return s.behavior=yr(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(he).catch(he)}ensureInfiniteQueryData(s){return s.behavior=yr(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return os.isOnline()?c(this,Ke).resumePausedMutations():Promise.resolve()}getQueryCache(){return c(this,te)}getMutationCache(){return c(this,Ke)}getDefaultOptions(){return c(this,Ve)}setDefaultOptions(s){O(this,Ve,s)}setQueryDefaults(s,t){c(this,Tt).set(yt(s),{queryKey:s,defaultOptions:t})}getQueryDefaults(s){const t=[...c(this,Tt).values()],r={};return t.forEach(a=>{zt(s,a.queryKey)&&Object.assign(r,a.defaultOptions)}),r}setMutationDefaults(s,t){c(this,Dt).set(yt(s),{mutationKey:s,defaultOptions:t})}getMutationDefaults(s){const t=[...c(this,Dt).values()],r={};return t.forEach(a=>{zt(s,a.mutationKey)&&Object.assign(r,a.defaultOptions)}),r}defaultQueryOptions(s){if(s._defaulted)return s;const t={...c(this,Ve).queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return t.queryHash||(t.queryHash=Zs(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===er&&(t.enabled=!1),t}defaultMutationOptions(s){return s!=null&&s._defaulted?s:{...c(this,Ve).mutations,...(s==null?void 0:s.mutationKey)&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){c(this,te).clear(),c(this,Ke).clear()}},te=new WeakMap,Ke=new WeakMap,Ve=new WeakMap,Tt=new WeakMap,Dt=new WeakMap,We=new WeakMap,Rt=new WeakMap,Ot=new WeakMap,Vr),xe,W,Jt,ue,ht,Pt,Je,Ge,Gt,Ft,Lt,mt,xt,Ye,Mt,Y,Qt,Ls,Ms,qs,$s,Us,Is,Bs,ca,Wr,pn=(Wr=class extends qt{constructor(t,r){super();L(this,Y);L(this,xe);L(this,W);L(this,Jt);L(this,ue);L(this,ht);L(this,Pt);L(this,Je);L(this,Ge);L(this,Gt);L(this,Ft);L(this,Lt);L(this,mt);L(this,xt);L(this,Ye);L(this,Mt,new Set);this.options=r,O(this,xe,t),O(this,Ge,null),O(this,Je,Fs()),this.options.experimental_prefetchInRender||c(this,Je).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(c(this,W).addObserver(this),br(c(this,W),this.options)?B(this,Y,Qt).call(this):this.updateResult(),B(this,Y,$s).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Qs(c(this,W),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Qs(c(this,W),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,B(this,Y,Us).call(this),B(this,Y,Is).call(this),c(this,W).removeObserver(this)}setOptions(t){const r=this.options,a=c(this,W);if(this.options=c(this,xe).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof we(this.options.enabled,c(this,W))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");B(this,Y,Bs).call(this),c(this,W).setOptions(this.options),r._defaulted&&!cs(this.options,r)&&c(this,xe).getQueryCache().notify({type:"observerOptionsUpdated",query:c(this,W),observer:this});const n=this.hasListeners();n&&jr(c(this,W),a,this.options,r)&&B(this,Y,Qt).call(this),this.updateResult(),n&&(c(this,W)!==a||we(this.options.enabled,c(this,W))!==we(r.enabled,c(this,W))||et(this.options.staleTime,c(this,W))!==et(r.staleTime,c(this,W)))&&B(this,Y,Ls).call(this);const l=B(this,Y,Ms).call(this);n&&(c(this,W)!==a||we(this.options.enabled,c(this,W))!==we(r.enabled,c(this,W))||l!==c(this,Ye))&&B(this,Y,qs).call(this,l)}getOptimisticResult(t){const r=c(this,xe).getQueryCache().build(c(this,xe),t),a=this.createResult(r,t);return yn(this,a)&&(O(this,ue,a),O(this,Pt,this.options),O(this,ht,c(this,W).state)),a}getCurrentResult(){return c(this,ue)}trackResult(t,r){return new Proxy(t,{get:(a,n)=>(this.trackProp(n),r==null||r(n),Reflect.get(a,n))})}trackProp(t){c(this,Mt).add(t)}getCurrentQuery(){return c(this,W)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=c(this,xe).defaultQueryOptions(t),a=c(this,xe).getQueryCache().build(c(this,xe),r);return a.fetch().then(()=>this.createResult(a,r))}fetch(t){return B(this,Y,Qt).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),c(this,ue)))}createResult(t,r){var M;const a=c(this,W),n=this.options,l=c(this,ue),i=c(this,ht),o=c(this,Pt),m=t!==a?t.state:c(this,Jt),{state:p}=t;let y={...p},b=!1,C;if(r._optimisticResults){const K=this.hasListeners(),V=!K&&br(t,r),T=K&&jr(t,a,r,n);(V||T)&&(y={...y,...ia(p.data,t.options)}),r._optimisticResults==="isRestoring"&&(y.fetchStatus="idle")}let{error:d,errorUpdatedAt:N,status:x}=y;C=y.data;let k=!1;if(r.placeholderData!==void 0&&C===void 0&&x==="pending"){let K;l!=null&&l.isPlaceholderData&&r.placeholderData===(o==null?void 0:o.placeholderData)?(K=l.data,k=!0):K=typeof r.placeholderData=="function"?r.placeholderData((M=c(this,Lt))==null?void 0:M.state.data,c(this,Lt)):r.placeholderData,K!==void 0&&(x="success",C=Ps(l==null?void 0:l.data,K,r),b=!0)}if(r.select&&C!==void 0&&!k)if(l&&C===(i==null?void 0:i.data)&&r.select===c(this,Gt))C=c(this,Ft);else try{O(this,Gt,r.select),C=r.select(C),C=Ps(l==null?void 0:l.data,C,r),O(this,Ft,C),O(this,Ge,null)}catch(K){O(this,Ge,K)}c(this,Ge)&&(d=c(this,Ge),C=c(this,Ft),N=Date.now(),x="error");const _=y.fetchStatus==="fetching",v=x==="pending",f=x==="error",D=v&&_,P=C!==void 0,F={status:x,fetchStatus:y.fetchStatus,isPending:v,isSuccess:x==="success",isError:f,isInitialLoading:D,isLoading:D,data:C,dataUpdatedAt:y.dataUpdatedAt,error:d,errorUpdatedAt:N,failureCount:y.fetchFailureCount,failureReason:y.fetchFailureReason,errorUpdateCount:y.errorUpdateCount,isFetched:y.dataUpdateCount>0||y.errorUpdateCount>0,isFetchedAfterMount:y.dataUpdateCount>m.dataUpdateCount||y.errorUpdateCount>m.errorUpdateCount,isFetching:_,isRefetching:_&&!v,isLoadingError:f&&!P,isPaused:y.fetchStatus==="paused",isPlaceholderData:b,isRefetchError:f&&P,isStale:sr(t,r),refetch:this.refetch,promise:c(this,Je),isEnabled:we(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const K=Q=>{F.status==="error"?Q.reject(F.error):F.data!==void 0&&Q.resolve(F.data)},V=()=>{const Q=O(this,Je,F.promise=Fs());K(Q)},T=c(this,Je);switch(T.status){case"pending":t.queryHash===a.queryHash&&K(T);break;case"fulfilled":(F.status==="error"||F.data!==T.value)&&V();break;case"rejected":(F.status!=="error"||F.error!==T.reason)&&V();break}}return F}updateResult(){const t=c(this,ue),r=this.createResult(c(this,W),this.options);if(O(this,ht,c(this,W).state),O(this,Pt,this.options),c(this,ht).data!==void 0&&O(this,Lt,c(this,W)),cs(r,t))return;O(this,ue,r);const a=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,l=typeof n=="function"?n():n;if(l==="all"||!l&&!c(this,Mt).size)return!0;const i=new Set(l??c(this,Mt));return this.options.throwOnError&&i.add("error"),Object.keys(c(this,ue)).some(o=>{const h=o;return c(this,ue)[h]!==t[h]&&i.has(h)})};B(this,Y,ca).call(this,{listeners:a()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&B(this,Y,$s).call(this)}},xe=new WeakMap,W=new WeakMap,Jt=new WeakMap,ue=new WeakMap,ht=new WeakMap,Pt=new WeakMap,Je=new WeakMap,Ge=new WeakMap,Gt=new WeakMap,Ft=new WeakMap,Lt=new WeakMap,mt=new WeakMap,xt=new WeakMap,Ye=new WeakMap,Mt=new WeakMap,Y=new WeakSet,Qt=function(t){B(this,Y,Bs).call(this);let r=c(this,W).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(he)),r},Ls=function(){B(this,Y,Us).call(this);const t=et(this.options.staleTime,c(this,W));if(ft||c(this,ue).isStale||!Rs(t))return;const a=Xr(c(this,ue).dataUpdatedAt,t)+1;O(this,mt,setTimeout(()=>{c(this,ue).isStale||this.updateResult()},a))},Ms=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(c(this,W)):this.options.refetchInterval)??!1},qs=function(t){B(this,Y,Is).call(this),O(this,Ye,t),!(ft||we(this.options.enabled,c(this,W))===!1||!Rs(c(this,Ye))||c(this,Ye)===0)&&O(this,xt,setInterval(()=>{(this.options.refetchIntervalInBackground||tr.isFocused())&&B(this,Y,Qt).call(this)},c(this,Ye)))},$s=function(){B(this,Y,Ls).call(this),B(this,Y,qs).call(this,B(this,Y,Ms).call(this))},Us=function(){c(this,mt)&&(clearTimeout(c(this,mt)),O(this,mt,void 0))},Is=function(){c(this,xt)&&(clearInterval(c(this,xt)),O(this,xt,void 0))},Bs=function(){const t=c(this,xe).getQueryCache().build(c(this,xe),this.options);if(t===c(this,W))return;const r=c(this,W);O(this,W,t),O(this,Jt,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},ca=function(t){re.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(c(this,ue))}),c(this,xe).getQueryCache().notify({query:c(this,W),type:"observerResultsUpdated"})})},Wr);function fn(s,t){return we(t.enabled,s)!==!1&&s.state.data===void 0&&!(s.state.status==="error"&&t.retryOnMount===!1)}function br(s,t){return fn(s,t)||s.state.data!==void 0&&Qs(s,t,t.refetchOnMount)}function Qs(s,t,r){if(we(t.enabled,s)!==!1&&et(t.staleTime,s)!=="static"){const a=typeof r=="function"?r(s):r;return a==="always"||a!==!1&&sr(s,t)}return!1}function jr(s,t,r,a){return(s!==t||we(a.enabled,s)===!1)&&(!r.suspense||s.state.status!=="error")&&sr(s,r)}function sr(s,t){return we(t.enabled,s)!==!1&&s.isStaleByTime(et(t.staleTime,s))}function yn(s,t){return!cs(s.getCurrentResult(),t)}var Xe,Ze,pe,Ue,Be,rs,zs,Jr,gn=(Jr=class extends qt{constructor(r,a){super();L(this,Be);L(this,Xe);L(this,Ze);L(this,pe);L(this,Ue);O(this,Xe,r),this.setOptions(a),this.bindMethods(),B(this,Be,rs).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var n;const a=this.options;this.options=c(this,Xe).defaultMutationOptions(r),cs(this.options,a)||c(this,Xe).getMutationCache().notify({type:"observerOptionsUpdated",mutation:c(this,pe),observer:this}),a!=null&&a.mutationKey&&this.options.mutationKey&&yt(a.mutationKey)!==yt(this.options.mutationKey)?this.reset():((n=c(this,pe))==null?void 0:n.state.status)==="pending"&&c(this,pe).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=c(this,pe))==null||r.removeObserver(this)}onMutationUpdate(r){B(this,Be,rs).call(this),B(this,Be,zs).call(this,r)}getCurrentResult(){return c(this,Ze)}reset(){var r;(r=c(this,pe))==null||r.removeObserver(this),O(this,pe,void 0),B(this,Be,rs).call(this),B(this,Be,zs).call(this)}mutate(r,a){var n;return O(this,Ue,a),(n=c(this,pe))==null||n.removeObserver(this),O(this,pe,c(this,Xe).getMutationCache().build(c(this,Xe),this.options)),c(this,pe).addObserver(this),c(this,pe).execute(r)}},Xe=new WeakMap,Ze=new WeakMap,pe=new WeakMap,Ue=new WeakMap,Be=new WeakSet,rs=function(){var a;const r=((a=c(this,pe))==null?void 0:a.state)??la();O(this,Ze,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},zs=function(r){re.batch(()=>{var a,n,l,i,o,h,m,p;if(c(this,Ue)&&this.hasListeners()){const y=c(this,Ze).variables,b=c(this,Ze).context;(r==null?void 0:r.type)==="success"?((n=(a=c(this,Ue)).onSuccess)==null||n.call(a,r.data,y,b),(i=(l=c(this,Ue)).onSettled)==null||i.call(l,r.data,null,y,b)):(r==null?void 0:r.type)==="error"&&((h=(o=c(this,Ue)).onError)==null||h.call(o,r.error,y,b),(p=(m=c(this,Ue)).onSettled)==null||p.call(m,void 0,r.error,y,b))}this.listeners.forEach(y=>{y(c(this,Ze))})})},Jr),oa=S.createContext(void 0),jt=s=>{const t=S.useContext(oa);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},bn=({client:s,children:t})=>(S.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),e.jsx(oa.Provider,{value:s,children:t})),da=S.createContext(!1),jn=()=>S.useContext(da);da.Provider;function Nn(){let s=!1;return{clearReset:()=>{s=!1},reset:()=>{s=!0},isReset:()=>s}}var vn=S.createContext(Nn()),wn=()=>S.useContext(vn),Sn=(s,t)=>{(s.suspense||s.throwOnError||s.experimental_prefetchInRender)&&(t.isReset()||(s.retryOnMount=!1))},Cn=s=>{S.useEffect(()=>{s.clearReset()},[s])},kn=({result:s,errorResetBoundary:t,throwOnError:r,query:a,suspense:n})=>s.isError&&!t.isReset()&&!s.isFetching&&a&&(n&&s.data===void 0||ta(r,[s.error,a])),_n=s=>{if(s.suspense){const t=a=>a==="static"?a:Math.max(a??1e3,1e3),r=s.staleTime;s.staleTime=typeof r=="function"?(...a)=>t(r(...a)):t(r),typeof s.gcTime=="number"&&(s.gcTime=Math.max(s.gcTime,1e3))}},An=(s,t)=>s.isLoading&&s.isFetching&&!t,En=(s,t)=>(s==null?void 0:s.suspense)&&t.isPending,Nr=(s,t,r)=>t.fetchOptimistic(s).catch(()=>{r.clearReset()});function Tn(s,t,r){var y,b,C,d,N;const a=jn(),n=wn(),l=jt(),i=l.defaultQueryOptions(s);(b=(y=l.getDefaultOptions().queries)==null?void 0:y._experimental_beforeQuery)==null||b.call(y,i),i._optimisticResults=a?"isRestoring":"optimistic",_n(i),Sn(i,n),Cn(n);const o=!l.getQueryCache().get(i.queryHash),[h]=S.useState(()=>new t(l,i)),m=h.getOptimisticResult(i),p=!a&&s.subscribed!==!1;if(S.useSyncExternalStore(S.useCallback(x=>{const k=p?h.subscribe(re.batchCalls(x)):he;return h.updateResult(),k},[h,p]),()=>h.getCurrentResult(),()=>h.getCurrentResult()),S.useEffect(()=>{h.setOptions(i)},[i,h]),En(i,m))throw Nr(i,h,n);if(kn({result:m,errorResetBoundary:n,throwOnError:i.throwOnError,query:l.getQueryCache().get(i.queryHash),suspense:i.suspense}))throw m.error;if((d=(C=l.getDefaultOptions().queries)==null?void 0:C._experimental_afterQuery)==null||d.call(C,i,m),i.experimental_prefetchInRender&&!ft&&An(m,a)){const x=o?Nr(i,h,n):(N=l.getQueryCache().get(i.queryHash))==null?void 0:N.promise;x==null||x.catch(he).finally(()=>{h.updateResult()})}return i.notifyOnChangeProps?m:h.trackResult(m)}function ie(s,t){return Tn(s,pn)}function _e(s,t){const r=jt(),[a]=S.useState(()=>new gn(r,s));S.useEffect(()=>{a.setOptions(s)},[a,s]);const n=S.useSyncExternalStore(S.useCallback(i=>a.subscribe(re.batchCalls(i)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),l=S.useCallback((i,o)=>{a.mutate(i,o).catch(he)},[a]);if(n.error&&ta(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:l,mutateAsync:n.mutate}}const ua=S.createContext(null),ps=()=>{const s=S.useContext(ua);if(!s)throw new Error("useAuth must be used within an AuthProvider");return s},Dn=({children:s})=>{const[t,r]=S.useState(null),[a,n]=S.useState(!0),l=async()=>{try{const m=await fetch("/api/auth/me",{credentials:"include"});if(m.ok){const p=await m.json();r(p.data)}else r(null)}catch(m){console.error("Failed to refresh user:",m),r(null)}},i=async(m,p)=>{const y=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:m,password:p})}),b=await y.json();if(!y.ok)throw new Error(b.error||"Login failed");r(b.data.user)},o=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(m){console.error("Logout error:",m)}finally{r(null)}};S.useEffect(()=>{l().finally(()=>n(!1))},[]);const h={user:t,isLoading:a,isAuthenticated:!!t,login:i,logout:o,refreshUser:l};return e.jsx(ua.Provider,{value:h,children:s})};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Rn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),$=(s,t)=>{const r=S.forwardRef(({color:a="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:o="",children:h,...m},p)=>S.createElement("svg",{ref:p,...Rn,width:n,height:n,stroke:a,strokeWidth:i?Number(l)*24/Number(n):l,className:["lucide",`lucide-${On(s)}`,o].join(" "),...m},[...t.map(([y,b])=>S.createElement(y,b)),...Array.isArray(h)?h:[h]]));return r.displayName=`${s}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=$("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=$("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=$("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=$("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=$("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=$("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vr=$("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=$("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=$("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=$("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=$("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=$("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=$("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=$("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=$("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=$("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=$("FileImage",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["circle",{cx:"10",cy:"13",r:"2",key:"6v46hv"}],["path",{d:"m20 17-1.09-1.09a2 2 0 0 0-2.82 0L10 22",key:"17vly1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=$("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=$("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=$("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=$("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=$("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Un=$("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=$("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=$("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=$("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=$("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=$("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=$("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=$("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=$("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=$("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=$("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zn=$("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=$("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=$("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=$("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=$("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=$("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=$("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=$("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=$("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=$("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Wn=[{name:"Dashboard",href:"/",icon:Un},{name:"Trades",href:"/trades",icon:gt},{name:"Positions",href:"/positions",icon:nr},{name:"Bank Accounts",href:"/accounts",icon:wt},{name:"Trading Parties",href:"/parties",icon:je},{name:"Receipts",href:"/receipts",icon:St},{name:"Statements",href:"/counterparts",icon:us},{name:"Journal",href:"/journal",icon:Hs}];function Jn(){const{user:s,logout:t}=ps(),r=async()=>{try{await t()}catch(a){console.error("Logout failed:",a)}};return e.jsx("div",{className:"hidden md:flex md:w-64 md:flex-col",children:e.jsxs("div",{className:"flex flex-col flex-grow pt-5 bg-white border-r border-gray-200 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center flex-shrink-0 px-4",children:[e.jsx(Mn,{className:"h-8 w-8 text-primary-600"}),e.jsx("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Agrivex"})]}),e.jsx("div",{className:"mt-8 flex-grow flex flex-col",children:e.jsxs("nav",{className:"flex-1 px-2 space-y-1",children:[Wn.map(a=>e.jsxs(ur,{to:a.href,className:({isActive:n})=>`group flex items-center px-2 py-2 text-sm font-medium rounded-md transition-colors ${n?"bg-primary-100 text-primary-900 border-r-2 border-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[e.jsx(a.icon,{className:"mr-3 h-5 w-5 flex-shrink-0"}),a.name]},a.name)),(s==null?void 0:s.role)==="superadmin"&&e.jsxs(ur,{to:"/users",className:({isActive:a})=>`group flex items-center px-2 py-2 text-sm font-medium rounded-md transition-colors ${a?"bg-primary-100 text-primary-900 border-r-2 border-primary-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[e.jsx(zn,{className:"mr-3 h-5 w-5 flex-shrink-0"}),"User Management"]})]})}),e.jsxs("div",{className:"flex-shrink-0 border-t border-gray-200",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 bg-gray-300 rounded-full flex items-center justify-center",children:e.jsx(fs,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:s!=null&&s.first_name&&(s!=null&&s.last_name)?`${s.first_name} ${s.last_name}`:s==null?void 0:s.username}),e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${(s==null?void 0:s.role)==="superadmin"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:[(s==null?void 0:s.role)==="superadmin"&&e.jsx(Ks,{className:"h-2.5 w-2.5 mr-1"}),s==null?void 0:s.role]})})]})]})}),e.jsx("div",{className:"p-4",children:e.jsxs("button",{onClick:r,className:"w-full flex items-center px-2 py-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-50 hover:text-gray-900 transition-colors",children:[e.jsx(Bn,{className:"mr-3 h-5 w-5 flex-shrink-0"}),"Sign Out"]})}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("div",{className:"font-medium",children:"Currency Trading System"}),e.jsx("div",{children:"Toman  AED Exchange"})]})})]})]})})}function pa(s,t){return function(){return s.apply(t,arguments)}}const{toString:Gn}=Object.prototype,{getPrototypeOf:lr}=Object,{iterator:ys,toStringTag:fa}=Symbol,gs=(s=>t=>{const r=Gn.call(t);return s[r]||(s[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ae=s=>(s=s.toLowerCase(),t=>gs(t)===s),bs=s=>t=>typeof t===s,{isArray:Ut}=Array,Kt=bs("undefined");function Yn(s){return s!==null&&!Kt(s)&&s.constructor!==null&&!Kt(s.constructor)&&fe(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const ya=Ae("ArrayBuffer");function Xn(s){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(s):t=s&&s.buffer&&ya(s.buffer),t}const Zn=bs("string"),fe=bs("function"),ga=bs("number"),js=s=>s!==null&&typeof s=="object",ei=s=>s===!0||s===!1,ns=s=>{if(gs(s)!=="object")return!1;const t=lr(s);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(fa in s)&&!(ys in s)},ti=Ae("Date"),si=Ae("File"),ri=Ae("Blob"),ai=Ae("FileList"),ni=s=>js(s)&&fe(s.pipe),ii=s=>{let t;return s&&(typeof FormData=="function"&&s instanceof FormData||fe(s.append)&&((t=gs(s))==="formdata"||t==="object"&&fe(s.toString)&&s.toString()==="[object FormData]"))},li=Ae("URLSearchParams"),[ci,oi,di,ui]=["ReadableStream","Request","Response","Headers"].map(Ae),hi=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Yt(s,t,{allOwnKeys:r=!1}={}){if(s===null||typeof s>"u")return;let a,n;if(typeof s!="object"&&(s=[s]),Ut(s))for(a=0,n=s.length;a<n;a++)t.call(null,s[a],a,s);else{const l=r?Object.getOwnPropertyNames(s):Object.keys(s),i=l.length;let o;for(a=0;a<i;a++)o=l[a],t.call(null,s[o],o,s)}}function ba(s,t){t=t.toLowerCase();const r=Object.keys(s);let a=r.length,n;for(;a-- >0;)if(n=r[a],t===n.toLowerCase())return n;return null}const nt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ja=s=>!Kt(s)&&s!==nt;function Vs(){const{caseless:s}=ja(this)&&this||{},t={},r=(a,n)=>{const l=s&&ba(t,n)||n;ns(t[l])&&ns(a)?t[l]=Vs(t[l],a):ns(a)?t[l]=Vs({},a):Ut(a)?t[l]=a.slice():t[l]=a};for(let a=0,n=arguments.length;a<n;a++)arguments[a]&&Yt(arguments[a],r);return t}const mi=(s,t,r,{allOwnKeys:a}={})=>(Yt(t,(n,l)=>{r&&fe(n)?s[l]=pa(n,r):s[l]=n},{allOwnKeys:a}),s),xi=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),pi=(s,t,r,a)=>{s.prototype=Object.create(t.prototype,a),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:t.prototype}),r&&Object.assign(s.prototype,r)},fi=(s,t,r,a)=>{let n,l,i;const o={};if(t=t||{},s==null)return t;do{for(n=Object.getOwnPropertyNames(s),l=n.length;l-- >0;)i=n[l],(!a||a(i,s,t))&&!o[i]&&(t[i]=s[i],o[i]=!0);s=r!==!1&&lr(s)}while(s&&(!r||r(s,t))&&s!==Object.prototype);return t},yi=(s,t,r)=>{s=String(s),(r===void 0||r>s.length)&&(r=s.length),r-=t.length;const a=s.indexOf(t,r);return a!==-1&&a===r},gi=s=>{if(!s)return null;if(Ut(s))return s;let t=s.length;if(!ga(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=s[t];return r},bi=(s=>t=>s&&t instanceof s)(typeof Uint8Array<"u"&&lr(Uint8Array)),ji=(s,t)=>{const a=(s&&s[ys]).call(s);let n;for(;(n=a.next())&&!n.done;){const l=n.value;t.call(s,l[0],l[1])}},Ni=(s,t)=>{let r;const a=[];for(;(r=s.exec(t))!==null;)a.push(r);return a},vi=Ae("HTMLFormElement"),wi=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),_r=(({hasOwnProperty:s})=>(t,r)=>s.call(t,r))(Object.prototype),Si=Ae("RegExp"),Na=(s,t)=>{const r=Object.getOwnPropertyDescriptors(s),a={};Yt(r,(n,l)=>{let i;(i=t(n,l,s))!==!1&&(a[l]=i||n)}),Object.defineProperties(s,a)},Ci=s=>{Na(s,(t,r)=>{if(fe(s)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=s[r];if(fe(a)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},ki=(s,t)=>{const r={},a=n=>{n.forEach(l=>{r[l]=!0})};return Ut(s)?a(s):a(String(s).split(t)),r},_i=()=>{},Ai=(s,t)=>s!=null&&Number.isFinite(s=+s)?s:t;function Ei(s){return!!(s&&fe(s.append)&&s[fa]==="FormData"&&s[ys])}const Ti=s=>{const t=new Array(10),r=(a,n)=>{if(js(a)){if(t.indexOf(a)>=0)return;if(!("toJSON"in a)){t[n]=a;const l=Ut(a)?[]:{};return Yt(a,(i,o)=>{const h=r(i,n+1);!Kt(h)&&(l[o]=h)}),t[n]=void 0,l}}return a};return r(s,0)},Di=Ae("AsyncFunction"),Ri=s=>s&&(js(s)||fe(s))&&fe(s.then)&&fe(s.catch),va=((s,t)=>s?setImmediate:t?((r,a)=>(nt.addEventListener("message",({source:n,data:l})=>{n===nt&&l===r&&a.length&&a.shift()()},!1),n=>{a.push(n),nt.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",fe(nt.postMessage)),Oi=typeof queueMicrotask<"u"?queueMicrotask.bind(nt):typeof process<"u"&&process.nextTick||va,Pi=s=>s!=null&&fe(s[ys]),g={isArray:Ut,isArrayBuffer:ya,isBuffer:Yn,isFormData:ii,isArrayBufferView:Xn,isString:Zn,isNumber:ga,isBoolean:ei,isObject:js,isPlainObject:ns,isReadableStream:ci,isRequest:oi,isResponse:di,isHeaders:ui,isUndefined:Kt,isDate:ti,isFile:si,isBlob:ri,isRegExp:Si,isFunction:fe,isStream:ni,isURLSearchParams:li,isTypedArray:bi,isFileList:ai,forEach:Yt,merge:Vs,extend:mi,trim:hi,stripBOM:xi,inherits:pi,toFlatObject:fi,kindOf:gs,kindOfTest:Ae,endsWith:yi,toArray:gi,forEachEntry:ji,matchAll:Ni,isHTMLForm:vi,hasOwnProperty:_r,hasOwnProp:_r,reduceDescriptors:Na,freezeMethods:Ci,toObjectSet:ki,toCamelCase:wi,noop:_i,toFiniteNumber:Ai,findKey:ba,global:nt,isContextDefined:ja,isSpecCompliantForm:Ei,toJSONObject:Ti,isAsyncFn:Di,isThenable:Ri,setImmediate:va,asap:Oi,isIterable:Pi};function U(s,t,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}g.inherits(U,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:g.toJSONObject(this.config),code:this.code,status:this.status}}});const wa=U.prototype,Sa={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{Sa[s]={value:s}});Object.defineProperties(U,Sa);Object.defineProperty(wa,"isAxiosError",{value:!0});U.from=(s,t,r,a,n,l)=>{const i=Object.create(wa);return g.toFlatObject(s,i,function(h){return h!==Error.prototype},o=>o!=="isAxiosError"),U.call(i,s.message,t,r,a,n),i.cause=s,i.name=s.name,l&&Object.assign(i,l),i};const Fi=null;function Ws(s){return g.isPlainObject(s)||g.isArray(s)}function Ca(s){return g.endsWith(s,"[]")?s.slice(0,-2):s}function Ar(s,t,r){return s?s.concat(t).map(function(n,l){return n=Ca(n),!r&&l?"["+n+"]":n}).join(r?".":""):t}function Li(s){return g.isArray(s)&&!s.some(Ws)}const Mi=g.toFlatObject(g,{},null,function(t){return/^is[A-Z]/.test(t)});function Ns(s,t,r){if(!g.isObject(s))throw new TypeError("target must be an object");t=t||new FormData,r=g.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(N,x){return!g.isUndefined(x[N])});const a=r.metaTokens,n=r.visitor||p,l=r.dots,i=r.indexes,h=(r.Blob||typeof Blob<"u"&&Blob)&&g.isSpecCompliantForm(t);if(!g.isFunction(n))throw new TypeError("visitor must be a function");function m(d){if(d===null)return"";if(g.isDate(d))return d.toISOString();if(g.isBoolean(d))return d.toString();if(!h&&g.isBlob(d))throw new U("Blob is not supported. Use a Buffer instead.");return g.isArrayBuffer(d)||g.isTypedArray(d)?h&&typeof Blob=="function"?new Blob([d]):Buffer.from(d):d}function p(d,N,x){let k=d;if(d&&!x&&typeof d=="object"){if(g.endsWith(N,"{}"))N=a?N:N.slice(0,-2),d=JSON.stringify(d);else if(g.isArray(d)&&Li(d)||(g.isFileList(d)||g.endsWith(N,"[]"))&&(k=g.toArray(d)))return N=Ca(N),k.forEach(function(v,f){!(g.isUndefined(v)||v===null)&&t.append(i===!0?Ar([N],f,l):i===null?N:N+"[]",m(v))}),!1}return Ws(d)?!0:(t.append(Ar(x,N,l),m(d)),!1)}const y=[],b=Object.assign(Mi,{defaultVisitor:p,convertValue:m,isVisitable:Ws});function C(d,N){if(!g.isUndefined(d)){if(y.indexOf(d)!==-1)throw Error("Circular reference detected in "+N.join("."));y.push(d),g.forEach(d,function(k,_){(!(g.isUndefined(k)||k===null)&&n.call(t,k,g.isString(_)?_.trim():_,N,b))===!0&&C(k,N?N.concat(_):[_])}),y.pop()}}if(!g.isObject(s))throw new TypeError("data must be an object");return C(s),t}function Er(s){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(a){return t[a]})}function cr(s,t){this._pairs=[],s&&Ns(s,this,t)}const ka=cr.prototype;ka.append=function(t,r){this._pairs.push([t,r])};ka.toString=function(t){const r=t?function(a){return t.call(this,a,Er)}:Er;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function qi(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function _a(s,t,r){if(!t)return s;const a=r&&r.encode||qi;g.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let l;if(n?l=n(t,r):l=g.isURLSearchParams(t)?t.toString():new cr(t,r).toString(a),l){const i=s.indexOf("#");i!==-1&&(s=s.slice(0,i)),s+=(s.indexOf("?")===-1?"?":"&")+l}return s}class Tr{constructor(){this.handlers=[]}use(t,r,a){return this.handlers.push({fulfilled:t,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){g.forEach(this.handlers,function(a){a!==null&&t(a)})}}const Aa={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$i=typeof URLSearchParams<"u"?URLSearchParams:cr,Ui=typeof FormData<"u"?FormData:null,Ii=typeof Blob<"u"?Blob:null,Bi={isBrowser:!0,classes:{URLSearchParams:$i,FormData:Ui,Blob:Ii},protocols:["http","https","file","blob","url","data"]},or=typeof window<"u"&&typeof document<"u",Js=typeof navigator=="object"&&navigator||void 0,Qi=or&&(!Js||["ReactNative","NativeScript","NS"].indexOf(Js.product)<0),zi=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Hi=or&&window.location.href||"http://localhost",Ki=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:or,hasStandardBrowserEnv:Qi,hasStandardBrowserWebWorkerEnv:zi,navigator:Js,origin:Hi},Symbol.toStringTag,{value:"Module"})),oe={...Ki,...Bi};function Vi(s,t){return Ns(s,new oe.classes.URLSearchParams,Object.assign({visitor:function(r,a,n,l){return oe.isNode&&g.isBuffer(r)?(this.append(a,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function Wi(s){return g.matchAll(/\w+|\[(\w*)]/g,s).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Ji(s){const t={},r=Object.keys(s);let a;const n=r.length;let l;for(a=0;a<n;a++)l=r[a],t[l]=s[l];return t}function Ea(s){function t(r,a,n,l){let i=r[l++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),h=l>=r.length;return i=!i&&g.isArray(n)?n.length:i,h?(g.hasOwnProp(n,i)?n[i]=[n[i],a]:n[i]=a,!o):((!n[i]||!g.isObject(n[i]))&&(n[i]=[]),t(r,a,n[i],l)&&g.isArray(n[i])&&(n[i]=Ji(n[i])),!o)}if(g.isFormData(s)&&g.isFunction(s.entries)){const r={};return g.forEachEntry(s,(a,n)=>{t(Wi(a),n,r,0)}),r}return null}function Gi(s,t,r){if(g.isString(s))try{return(t||JSON.parse)(s),g.trim(s)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(s)}const Xt={transitional:Aa,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,l=g.isObject(t);if(l&&g.isHTMLForm(t)&&(t=new FormData(t)),g.isFormData(t))return n?JSON.stringify(Ea(t)):t;if(g.isArrayBuffer(t)||g.isBuffer(t)||g.isStream(t)||g.isFile(t)||g.isBlob(t)||g.isReadableStream(t))return t;if(g.isArrayBufferView(t))return t.buffer;if(g.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(l){if(a.indexOf("application/x-www-form-urlencoded")>-1)return Vi(t,this.formSerializer).toString();if((o=g.isFileList(t))||a.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return Ns(o?{"files[]":t}:t,h&&new h,this.formSerializer)}}return l||n?(r.setContentType("application/json",!1),Gi(t)):t}],transformResponse:[function(t){const r=this.transitional||Xt.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(g.isResponse(t)||g.isReadableStream(t))return t;if(t&&g.isString(t)&&(a&&!this.responseType||n)){const i=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(t)}catch(o){if(i)throw o.name==="SyntaxError"?U.from(o,U.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:oe.classes.FormData,Blob:oe.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};g.forEach(["delete","get","head","post","put","patch"],s=>{Xt.headers[s]={}});const Yi=g.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Xi=s=>{const t={};let r,a,n;return s&&s.split(`
`).forEach(function(i){n=i.indexOf(":"),r=i.substring(0,n).trim().toLowerCase(),a=i.substring(n+1).trim(),!(!r||t[r]&&Yi[r])&&(r==="set-cookie"?t[r]?t[r].push(a):t[r]=[a]:t[r]=t[r]?t[r]+", "+a:a)}),t},Dr=Symbol("internals");function Bt(s){return s&&String(s).trim().toLowerCase()}function is(s){return s===!1||s==null?s:g.isArray(s)?s.map(is):String(s)}function Zi(s){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(s);)t[a[1]]=a[2];return t}const el=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function As(s,t,r,a,n){if(g.isFunction(a))return a.call(this,t,r);if(n&&(t=r),!!g.isString(t)){if(g.isString(a))return t.indexOf(a)!==-1;if(g.isRegExp(a))return a.test(t)}}function tl(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,a)=>r.toUpperCase()+a)}function sl(s,t){const r=g.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(s,a+r,{value:function(n,l,i){return this[a].call(this,t,n,l,i)},configurable:!0})})}let ye=class{constructor(t){t&&this.set(t)}set(t,r,a){const n=this;function l(o,h,m){const p=Bt(h);if(!p)throw new Error("header name must be a non-empty string");const y=g.findKey(n,p);(!y||n[y]===void 0||m===!0||m===void 0&&n[y]!==!1)&&(n[y||h]=is(o))}const i=(o,h)=>g.forEach(o,(m,p)=>l(m,p,h));if(g.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(g.isString(t)&&(t=t.trim())&&!el(t))i(Xi(t),r);else if(g.isObject(t)&&g.isIterable(t)){let o={},h,m;for(const p of t){if(!g.isArray(p))throw TypeError("Object iterator must return a key-value pair");o[m=p[0]]=(h=o[m])?g.isArray(h)?[...h,p[1]]:[h,p[1]]:p[1]}i(o,r)}else t!=null&&l(r,t,a);return this}get(t,r){if(t=Bt(t),t){const a=g.findKey(this,t);if(a){const n=this[a];if(!r)return n;if(r===!0)return Zi(n);if(g.isFunction(r))return r.call(this,n,a);if(g.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Bt(t),t){const a=g.findKey(this,t);return!!(a&&this[a]!==void 0&&(!r||As(this,this[a],a,r)))}return!1}delete(t,r){const a=this;let n=!1;function l(i){if(i=Bt(i),i){const o=g.findKey(a,i);o&&(!r||As(a,a[o],o,r))&&(delete a[o],n=!0)}}return g.isArray(t)?t.forEach(l):l(t),n}clear(t){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const l=r[a];(!t||As(this,this[l],l,t,!0))&&(delete this[l],n=!0)}return n}normalize(t){const r=this,a={};return g.forEach(this,(n,l)=>{const i=g.findKey(a,l);if(i){r[i]=is(n),delete r[l];return}const o=t?tl(l):String(l).trim();o!==l&&delete r[l],r[o]=is(n),a[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return g.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=t&&g.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const a=new this(t);return r.forEach(n=>a.set(n)),a}static accessor(t){const a=(this[Dr]=this[Dr]={accessors:{}}).accessors,n=this.prototype;function l(i){const o=Bt(i);a[o]||(sl(n,i),a[o]=!0)}return g.isArray(t)?t.forEach(l):l(t),this}};ye.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);g.reduceDescriptors(ye.prototype,({value:s},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>s,set(a){this[r]=a}}});g.freezeMethods(ye);function Es(s,t){const r=this||Xt,a=t||r,n=ye.from(a.headers);let l=a.data;return g.forEach(s,function(o){l=o.call(r,l,n.normalize(),t?t.status:void 0)}),n.normalize(),l}function Ta(s){return!!(s&&s.__CANCEL__)}function It(s,t,r){U.call(this,s??"canceled",U.ERR_CANCELED,t,r),this.name="CanceledError"}g.inherits(It,U,{__CANCEL__:!0});function Da(s,t,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?s(r):t(new U("Request failed with status code "+r.status,[U.ERR_BAD_REQUEST,U.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function rl(s){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return t&&t[1]||""}function al(s,t){s=s||10;const r=new Array(s),a=new Array(s);let n=0,l=0,i;return t=t!==void 0?t:1e3,function(h){const m=Date.now(),p=a[l];i||(i=m),r[n]=h,a[n]=m;let y=l,b=0;for(;y!==n;)b+=r[y++],y=y%s;if(n=(n+1)%s,n===l&&(l=(l+1)%s),m-i<t)return;const C=p&&m-p;return C?Math.round(b*1e3/C):void 0}}function nl(s,t){let r=0,a=1e3/t,n,l;const i=(m,p=Date.now())=>{r=p,n=null,l&&(clearTimeout(l),l=null),s.apply(null,m)};return[(...m)=>{const p=Date.now(),y=p-r;y>=a?i(m,p):(n=m,l||(l=setTimeout(()=>{l=null,i(n)},a-y)))},()=>n&&i(n)]}const hs=(s,t,r=3)=>{let a=0;const n=al(50,250);return nl(l=>{const i=l.loaded,o=l.lengthComputable?l.total:void 0,h=i-a,m=n(h),p=i<=o;a=i;const y={loaded:i,total:o,progress:o?i/o:void 0,bytes:h,rate:m||void 0,estimated:m&&o&&p?(o-i)/m:void 0,event:l,lengthComputable:o!=null,[t?"download":"upload"]:!0};s(y)},r)},Rr=(s,t)=>{const r=s!=null;return[a=>t[0]({lengthComputable:r,total:s,loaded:a}),t[1]]},Or=s=>(...t)=>g.asap(()=>s(...t)),il=oe.hasStandardBrowserEnv?((s,t)=>r=>(r=new URL(r,oe.origin),s.protocol===r.protocol&&s.host===r.host&&(t||s.port===r.port)))(new URL(oe.origin),oe.navigator&&/(msie|trident)/i.test(oe.navigator.userAgent)):()=>!0,ll=oe.hasStandardBrowserEnv?{write(s,t,r,a,n,l){const i=[s+"="+encodeURIComponent(t)];g.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),g.isString(a)&&i.push("path="+a),g.isString(n)&&i.push("domain="+n),l===!0&&i.push("secure"),document.cookie=i.join("; ")},read(s){const t=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function cl(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function ol(s,t){return t?s.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):s}function Ra(s,t,r){let a=!cl(t);return s&&(a||r==!1)?ol(s,t):t}const Pr=s=>s instanceof ye?{...s}:s;function bt(s,t){t=t||{};const r={};function a(m,p,y,b){return g.isPlainObject(m)&&g.isPlainObject(p)?g.merge.call({caseless:b},m,p):g.isPlainObject(p)?g.merge({},p):g.isArray(p)?p.slice():p}function n(m,p,y,b){if(g.isUndefined(p)){if(!g.isUndefined(m))return a(void 0,m,y,b)}else return a(m,p,y,b)}function l(m,p){if(!g.isUndefined(p))return a(void 0,p)}function i(m,p){if(g.isUndefined(p)){if(!g.isUndefined(m))return a(void 0,m)}else return a(void 0,p)}function o(m,p,y){if(y in t)return a(m,p);if(y in s)return a(void 0,m)}const h={url:l,method:l,data:l,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(m,p,y)=>n(Pr(m),Pr(p),y,!0)};return g.forEach(Object.keys(Object.assign({},s,t)),function(p){const y=h[p]||n,b=y(s[p],t[p],p);g.isUndefined(b)&&y!==o||(r[p]=b)}),r}const Oa=s=>{const t=bt({},s);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:l,headers:i,auth:o}=t;t.headers=i=ye.from(i),t.url=_a(Ra(t.baseURL,t.url,t.allowAbsoluteUrls),s.params,s.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let h;if(g.isFormData(r)){if(oe.hasStandardBrowserEnv||oe.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((h=i.getContentType())!==!1){const[m,...p]=h?h.split(";").map(y=>y.trim()).filter(Boolean):[];i.setContentType([m||"multipart/form-data",...p].join("; "))}}if(oe.hasStandardBrowserEnv&&(a&&g.isFunction(a)&&(a=a(t)),a||a!==!1&&il(t.url))){const m=n&&l&&ll.read(l);m&&i.set(n,m)}return t},dl=typeof XMLHttpRequest<"u",ul=dl&&function(s){return new Promise(function(r,a){const n=Oa(s);let l=n.data;const i=ye.from(n.headers).normalize();let{responseType:o,onUploadProgress:h,onDownloadProgress:m}=n,p,y,b,C,d;function N(){C&&C(),d&&d(),n.cancelToken&&n.cancelToken.unsubscribe(p),n.signal&&n.signal.removeEventListener("abort",p)}let x=new XMLHttpRequest;x.open(n.method.toUpperCase(),n.url,!0),x.timeout=n.timeout;function k(){if(!x)return;const v=ye.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),D={data:!o||o==="text"||o==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:v,config:s,request:x};Da(function(z){r(z),N()},function(z){a(z),N()},D),x=null}"onloadend"in x?x.onloadend=k:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(k)},x.onabort=function(){x&&(a(new U("Request aborted",U.ECONNABORTED,s,x)),x=null)},x.onerror=function(){a(new U("Network Error",U.ERR_NETWORK,s,x)),x=null},x.ontimeout=function(){let f=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const D=n.transitional||Aa;n.timeoutErrorMessage&&(f=n.timeoutErrorMessage),a(new U(f,D.clarifyTimeoutError?U.ETIMEDOUT:U.ECONNABORTED,s,x)),x=null},l===void 0&&i.setContentType(null),"setRequestHeader"in x&&g.forEach(i.toJSON(),function(f,D){x.setRequestHeader(D,f)}),g.isUndefined(n.withCredentials)||(x.withCredentials=!!n.withCredentials),o&&o!=="json"&&(x.responseType=n.responseType),m&&([b,d]=hs(m,!0),x.addEventListener("progress",b)),h&&x.upload&&([y,C]=hs(h),x.upload.addEventListener("progress",y),x.upload.addEventListener("loadend",C)),(n.cancelToken||n.signal)&&(p=v=>{x&&(a(!v||v.type?new It(null,s,x):v),x.abort(),x=null)},n.cancelToken&&n.cancelToken.subscribe(p),n.signal&&(n.signal.aborted?p():n.signal.addEventListener("abort",p)));const _=rl(n.url);if(_&&oe.protocols.indexOf(_)===-1){a(new U("Unsupported protocol "+_+":",U.ERR_BAD_REQUEST,s));return}x.send(l||null)})},hl=(s,t)=>{const{length:r}=s=s?s.filter(Boolean):[];if(t||r){let a=new AbortController,n;const l=function(m){if(!n){n=!0,o();const p=m instanceof Error?m:this.reason;a.abort(p instanceof U?p:new It(p instanceof Error?p.message:p))}};let i=t&&setTimeout(()=>{i=null,l(new U(`timeout ${t} of ms exceeded`,U.ETIMEDOUT))},t);const o=()=>{s&&(i&&clearTimeout(i),i=null,s.forEach(m=>{m.unsubscribe?m.unsubscribe(l):m.removeEventListener("abort",l)}),s=null)};s.forEach(m=>m.addEventListener("abort",l));const{signal:h}=a;return h.unsubscribe=()=>g.asap(o),h}},ml=function*(s,t){let r=s.byteLength;if(r<t){yield s;return}let a=0,n;for(;a<r;)n=a+t,yield s.slice(a,n),a=n},xl=async function*(s,t){for await(const r of pl(s))yield*ml(r,t)},pl=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const t=s.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)break;yield a}}finally{await t.cancel()}},Fr=(s,t,r,a)=>{const n=xl(s,t);let l=0,i,o=h=>{i||(i=!0,a&&a(h))};return new ReadableStream({async pull(h){try{const{done:m,value:p}=await n.next();if(m){o(),h.close();return}let y=p.byteLength;if(r){let b=l+=y;r(b)}h.enqueue(new Uint8Array(p))}catch(m){throw o(m),m}},cancel(h){return o(h),n.return()}},{highWaterMark:2})},vs=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Pa=vs&&typeof ReadableStream=="function",fl=vs&&(typeof TextEncoder=="function"?(s=>t=>s.encode(t))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),Fa=(s,...t)=>{try{return!!s(...t)}catch{return!1}},yl=Pa&&Fa(()=>{let s=!1;const t=new Request(oe.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!t}),Lr=64*1024,Gs=Pa&&Fa(()=>g.isReadableStream(new Response("").body)),ms={stream:Gs&&(s=>s.body)};vs&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!ms[t]&&(ms[t]=g.isFunction(s[t])?r=>r[t]():(r,a)=>{throw new U(`Response type '${t}' is not supported`,U.ERR_NOT_SUPPORT,a)})})})(new Response);const gl=async s=>{if(s==null)return 0;if(g.isBlob(s))return s.size;if(g.isSpecCompliantForm(s))return(await new Request(oe.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(g.isArrayBufferView(s)||g.isArrayBuffer(s))return s.byteLength;if(g.isURLSearchParams(s)&&(s=s+""),g.isString(s))return(await fl(s)).byteLength},bl=async(s,t)=>{const r=g.toFiniteNumber(s.getContentLength());return r??gl(t)},jl=vs&&(async s=>{let{url:t,method:r,data:a,signal:n,cancelToken:l,timeout:i,onDownloadProgress:o,onUploadProgress:h,responseType:m,headers:p,withCredentials:y="same-origin",fetchOptions:b}=Oa(s);m=m?(m+"").toLowerCase():"text";let C=hl([n,l&&l.toAbortSignal()],i),d;const N=C&&C.unsubscribe&&(()=>{C.unsubscribe()});let x;try{if(h&&yl&&r!=="get"&&r!=="head"&&(x=await bl(p,a))!==0){let D=new Request(t,{method:"POST",body:a,duplex:"half"}),P;if(g.isFormData(a)&&(P=D.headers.get("content-type"))&&p.setContentType(P),D.body){const[z,F]=Rr(x,hs(Or(h)));a=Fr(D.body,Lr,z,F)}}g.isString(y)||(y=y?"include":"omit");const k="credentials"in Request.prototype;d=new Request(t,{...b,signal:C,method:r.toUpperCase(),headers:p.normalize().toJSON(),body:a,duplex:"half",credentials:k?y:void 0});let _=await fetch(d,b);const v=Gs&&(m==="stream"||m==="response");if(Gs&&(o||v&&N)){const D={};["status","statusText","headers"].forEach(M=>{D[M]=_[M]});const P=g.toFiniteNumber(_.headers.get("content-length")),[z,F]=o&&Rr(P,hs(Or(o),!0))||[];_=new Response(Fr(_.body,Lr,z,()=>{F&&F(),N&&N()}),D)}m=m||"text";let f=await ms[g.findKey(ms,m)||"text"](_,s);return!v&&N&&N(),await new Promise((D,P)=>{Da(D,P,{data:f,headers:ye.from(_.headers),status:_.status,statusText:_.statusText,config:s,request:d})})}catch(k){throw N&&N(),k&&k.name==="TypeError"&&/Load failed|fetch/i.test(k.message)?Object.assign(new U("Network Error",U.ERR_NETWORK,s,d),{cause:k.cause||k}):U.from(k,k&&k.code,s,d)}}),Ys={http:Fi,xhr:ul,fetch:jl};g.forEach(Ys,(s,t)=>{if(s){try{Object.defineProperty(s,"name",{value:t})}catch{}Object.defineProperty(s,"adapterName",{value:t})}});const Mr=s=>`- ${s}`,Nl=s=>g.isFunction(s)||s===null||s===!1,La={getAdapter:s=>{s=g.isArray(s)?s:[s];const{length:t}=s;let r,a;const n={};for(let l=0;l<t;l++){r=s[l];let i;if(a=r,!Nl(r)&&(a=Ys[(i=String(r)).toLowerCase()],a===void 0))throw new U(`Unknown adapter '${i}'`);if(a)break;n[i||"#"+l]=a}if(!a){const l=Object.entries(n).map(([o,h])=>`adapter ${o} `+(h===!1?"is not supported by the environment":"is not available in the build"));let i=t?l.length>1?`since :
`+l.map(Mr).join(`
`):" "+Mr(l[0]):"as no adapter specified";throw new U("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return a},adapters:Ys};function Ts(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new It(null,s)}function qr(s){return Ts(s),s.headers=ye.from(s.headers),s.data=Es.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),La.getAdapter(s.adapter||Xt.adapter)(s).then(function(a){return Ts(s),a.data=Es.call(s,s.transformResponse,a),a.headers=ye.from(a.headers),a},function(a){return Ta(a)||(Ts(s),a&&a.response&&(a.response.data=Es.call(s,s.transformResponse,a.response),a.response.headers=ye.from(a.response.headers))),Promise.reject(a)})}const Ma="1.10.0",ws={};["object","boolean","number","function","string","symbol"].forEach((s,t)=>{ws[s]=function(a){return typeof a===s||"a"+(t<1?"n ":" ")+s}});const $r={};ws.transitional=function(t,r,a){function n(l,i){return"[Axios v"+Ma+"] Transitional option '"+l+"'"+i+(a?". "+a:"")}return(l,i,o)=>{if(t===!1)throw new U(n(i," has been removed"+(r?" in "+r:"")),U.ERR_DEPRECATED);return r&&!$r[i]&&($r[i]=!0,console.warn(n(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(l,i,o):!0}};ws.spelling=function(t){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${t}`),!0)};function vl(s,t,r){if(typeof s!="object")throw new U("options must be an object",U.ERR_BAD_OPTION_VALUE);const a=Object.keys(s);let n=a.length;for(;n-- >0;){const l=a[n],i=t[l];if(i){const o=s[l],h=o===void 0||i(o,l,s);if(h!==!0)throw new U("option "+l+" must be "+h,U.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new U("Unknown option "+l,U.ERR_BAD_OPTION)}}const ls={assertOptions:vl,validators:ws},Te=ls.validators;let pt=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Tr,response:new Tr}}async request(t,r){try{return await this._request(t,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const l=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?l&&!String(a.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+l):a.stack=l}catch{}}throw a}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=bt(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:l}=r;a!==void 0&&ls.assertOptions(a,{silentJSONParsing:Te.transitional(Te.boolean),forcedJSONParsing:Te.transitional(Te.boolean),clarifyTimeoutError:Te.transitional(Te.boolean)},!1),n!=null&&(g.isFunction(n)?r.paramsSerializer={serialize:n}:ls.assertOptions(n,{encode:Te.function,serialize:Te.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),ls.assertOptions(r,{baseUrl:Te.spelling("baseURL"),withXsrfToken:Te.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=l&&g.merge(l.common,l[r.method]);l&&g.forEach(["delete","get","head","post","put","patch","common"],d=>{delete l[d]}),r.headers=ye.concat(i,l);const o=[];let h=!0;this.interceptors.request.forEach(function(N){typeof N.runWhen=="function"&&N.runWhen(r)===!1||(h=h&&N.synchronous,o.unshift(N.fulfilled,N.rejected))});const m=[];this.interceptors.response.forEach(function(N){m.push(N.fulfilled,N.rejected)});let p,y=0,b;if(!h){const d=[qr.bind(this),void 0];for(d.unshift.apply(d,o),d.push.apply(d,m),b=d.length,p=Promise.resolve(r);y<b;)p=p.then(d[y++],d[y++]);return p}b=o.length;let C=r;for(y=0;y<b;){const d=o[y++],N=o[y++];try{C=d(C)}catch(x){N.call(this,x);break}}try{p=qr.call(this,C)}catch(d){return Promise.reject(d)}for(y=0,b=m.length;y<b;)p=p.then(m[y++],m[y++]);return p}getUri(t){t=bt(this.defaults,t);const r=Ra(t.baseURL,t.url,t.allowAbsoluteUrls);return _a(r,t.params,t.paramsSerializer)}};g.forEach(["delete","get","head","options"],function(t){pt.prototype[t]=function(r,a){return this.request(bt(a||{},{method:t,url:r,data:(a||{}).data}))}});g.forEach(["post","put","patch"],function(t){function r(a){return function(l,i,o){return this.request(bt(o||{},{method:t,headers:a?{"Content-Type":"multipart/form-data"}:{},url:l,data:i}))}}pt.prototype[t]=r(),pt.prototype[t+"Form"]=r(!0)});let wl=class qa{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const a=this;this.promise.then(n=>{if(!a._listeners)return;let l=a._listeners.length;for(;l-- >0;)a._listeners[l](n);a._listeners=null}),this.promise.then=n=>{let l;const i=new Promise(o=>{a.subscribe(o),l=o}).then(n);return i.cancel=function(){a.unsubscribe(l)},i},t(function(l,i,o){a.reason||(a.reason=new It(l,i,o),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=a=>{t.abort(a)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new qa(function(n){t=n}),cancel:t}}};function Sl(s){return function(r){return s.apply(null,r)}}function Cl(s){return g.isObject(s)&&s.isAxiosError===!0}const Xs={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Xs).forEach(([s,t])=>{Xs[t]=s});function $a(s){const t=new pt(s),r=pa(pt.prototype.request,t);return g.extend(r,pt.prototype,t,{allOwnKeys:!0}),g.extend(r,t,null,{allOwnKeys:!0}),r.create=function(n){return $a(bt(s,n))},r}const se=$a(Xt);se.Axios=pt;se.CanceledError=It;se.CancelToken=wl;se.isCancel=Ta;se.VERSION=Ma;se.toFormData=Ns;se.AxiosError=U;se.Cancel=se.CanceledError;se.all=function(t){return Promise.all(t)};se.spread=Sl;se.isAxiosError=Cl;se.mergeConfig=bt;se.AxiosHeaders=ye;se.formToJSON=s=>Ea(g.isHTMLForm(s)?new FormData(s):s);se.getAdapter=La.getAdapter;se.HttpStatusCode=Xs;se.default=se;const{Axios:Vl,AxiosError:Wl,CanceledError:Jl,isCancel:Gl,CancelToken:Yl,VERSION:Xl,all:Zl,Cancel:ec,isAxiosError:tc,spread:sc,toFormData:rc,AxiosHeaders:ac,HttpStatusCode:nc,formToJSON:ic,getAdapter:lc,mergeConfig:cc}=se,kl="/api",J=se.create({baseURL:kl,headers:{"Content-Type":"application/json"}});J.interceptors.request.use(s=>s,s=>Promise.reject(s));J.interceptors.response.use(s=>s,s=>{var t,r;return((t=s.response)==null?void 0:t.status)===401||((r=s.response)==null?void 0:r.status)>=500&&console.error("Server error:",s.response.data),Promise.reject(s)});function _l(){var r;const{data:s}=ie({queryKey:["dashboard"],queryFn:()=>J.get("/dashboard").then(a=>a.data.data),refetchInterval:3e4}),t=(a,n)=>new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(a)+` ${n}`;return e.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{className:"md:hidden p-2 rounded-md text-gray-400 hover:text-gray-600",children:e.jsx(Qn,{className:"h-6 w-6"})}),e.jsx("h1",{className:"ml-2 text-2xl font-semibold text-gray-900",children:"Currency Trading Dashboard"})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[(s==null?void 0:s.balances)&&e.jsx("div",{className:"flex items-center space-x-4 px-4 py-2 bg-gray-50 rounded-lg",children:s.balances.map(a=>e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xs text-gray-500 uppercase",children:[a.currency," Balance"]}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:t(a.balance,a.currency)}),a.safe_balance>0&&e.jsxs("div",{className:"text-xs text-primary-600",children:["Safe: ",t(a.safe_balance,a.currency)]})]},a.currency))}),e.jsxs("button",{className:"p-2 text-gray-400 hover:text-gray-600 relative",children:[e.jsx(Ln,{className:"h-6 w-6"}),((r=s==null?void 0:s.pending_trades)==null?void 0:r.length)>0&&e.jsx("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-danger-600 rounded-full",children:s.pending_trades.length})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Agrivex Admin"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Currency Trader"})]}),e.jsx("div",{className:"ml-3 h-8 w-8 rounded-full bg-primary-600 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-white",children:"A"})})]})]})]})})}function Al(){const{data:s,isLoading:t}=ie({queryKey:["dashboard"],queryFn:()=>J.get("/dashboard").then(i=>i.data.data),refetchInterval:3e4}),r=(i,o)=>new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(i)+` ${o}`;if(t)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})});const a=(s==null?void 0:s.trade_status_counts.completed_count)||0,n=(s==null?void 0:s.trade_status_counts.partial_count)||0,l=(s==null?void 0:s.trade_status_counts.pending_count)||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Trading Dashboard"}),e.jsxs(Cs,{to:"/trades",className:"btn btn-primary",children:[e.jsx($t,{className:"h-4 w-4 mr-2"}),"New Trade"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ar,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Completed Trades"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:a})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ha,{className:"h-8 w-8 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Partial Settlements"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(rr,{className:"h-8 w-8 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Pending Trades"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:l})]})]})})}),s==null?void 0:s.balances.map(i=>e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(tt,{className:"h-8 w-8 text-primary-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-500",children:[i.currency," Balance"]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r(i.balance,i.currency)}),i.safe_balance>0&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Safe: ",r(i.safe_balance,i.currency)]})]})]})})},i.currency)),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(gt,{className:"h-8 w-8 text-success-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Monthly Profit (Toman)"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:r((s==null?void 0:s.profit_summary.monthly_profit_toman)||0,"TOMAN")})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(nr,{className:"h-8 w-8 text-warning-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Outstanding Positions"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(s==null?void 0:s.outstanding_positions.length)||0})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Pending Trades"})}),e.jsxs("div",{className:"card-body",children:[(s==null?void 0:s.pending_trades.length)===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No pending trades"}):e.jsx("div",{className:"space-y-3",children:s==null?void 0:s.pending_trades.slice(0,5).map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:i.trade_number}),e.jsxs("div",{className:"text-sm text-gray-600",children:[i.trade_type,": ",r(i.amount,i.base_currency)," @ ",i.rate]})]}),e.jsx("span",{className:`badge ${i.status==="PENDING"?"badge-warning":"badge-primary"}`,children:i.status})]},i.id))}),e.jsx("div",{className:"mt-4",children:e.jsx(Cs,{to:"/trades",className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"View all trades "})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Outstanding Positions"})}),e.jsxs("div",{className:"card-body",children:[(s==null?void 0:s.outstanding_positions.length)===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No outstanding positions"}):e.jsx("div",{className:"space-y-3",children:s==null?void 0:s.outstanding_positions.slice(0,5).map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:r(i.remaining_amount,i.currency)}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Avg Cost: ",i.average_cost_rate]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:i.trade_number}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(i.trade_date).toLocaleDateString()})]})]},i.id))}),e.jsx("div",{className:"mt-4",children:e.jsx(Cs,{to:"/positions",className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"View all positions "})})]})]})]})]})}function El(){var Ee;const[s,t]=S.useState(!1),[r,a]=S.useState(""),[n,l]=S.useState(""),[i,o]=S.useState(""),[h,m]=S.useState(""),[p,y]=S.useState(""),[b,C]=S.useState(""),[d,N]=S.useState(""),[x,k]=S.useState(""),[_,v]=S.useState(""),[f,D]=S.useState(""),[P,z]=S.useState(!0),[F,M]=S.useState(""),K=jt(),{data:V,isLoading:T}=ie({queryKey:["trades"],queryFn:()=>J.get("/trades").then(w=>w.data)}),{data:Q}=ie({queryKey:["parties"],queryFn:()=>J.get("/parties").then(w=>w.data.data)}),{data:E}=ie({queryKey:["positions"],queryFn:()=>J.get("/trades/positions/outstanding").then(w=>w.data.data),enabled:n==="SELL"&&P}),R=_e({mutationFn:w=>J.post("/trades",w),onSuccess:()=>{K.invalidateQueries({queryKey:["trades"]}),K.invalidateQueries({queryKey:["dashboard"]}),K.invalidateQueries({queryKey:["positions"]}),I(),t(!1)}}),I=()=>{l(""),o(""),m(""),y(""),C(""),N(""),k(""),v(""),D(""),z(!0),M("")},Z=(w,ee)=>new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(w)+` ${ee}`,H=w=>w.status==="COMPLETED"?"bg-green-100 text-green-800":w.status==="PARTIAL"?"bg-yellow-100 text-yellow-800":w.status==="CANCELLED"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800",Ne=w=>{if(w.status==="COMPLETED")return"Completed";if(w.status==="PARTIAL"){const ee=w.is_base_fully_settled?"":"",X=w.is_quote_fully_settled?"":"";return`Partial (${ee}${w.base_currency}/${X}${w.quote_currency})`}return w.status==="CANCELLED"?"Cancelled":"Pending"},Pe=({trade:w})=>{const ee=w.base_currency==="AED"?(w.progressAED||0)*100:(w.progressTOMAN||0)*100,X=w.quote_currency==="AED"?(w.progressAED||0)*100:(w.progressTOMAN||0)*100;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"w-8 font-mono",children:w.base_currency}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${ee===100?"bg-green-500":ee>0?"bg-blue-500":"bg-gray-300"}`,style:{width:`${ee}%`}})}),e.jsxs("span",{className:"w-10 text-right",children:[ee.toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"w-8 font-mono",children:w.quote_currency}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${X===100?"bg-green-500":X>0?"bg-blue-500":"bg-gray-300"}`,style:{width:`${X}%`}})}),e.jsxs("span",{className:"w-10 text-right",children:[X.toFixed(0),"%"]})]})]})},ge=()=>{if(!p||!d||!x)return 0;const w=parseFloat(p),ee=parseFloat(d),X=parseFloat(x);if(isNaN(w)||isNaN(ee)||isNaN(X))return 0;const le=w*ee;return w*X-le},me=(E==null?void 0:E.filter(w=>w.currency===i))||[],Fe=me.reduce((w,ee)=>w+ee.remaining_amount,0),rt=w=>{w.preventDefault();const ee=new FormData(w.currentTarget);let X={trade_type:n,base_currency:i,quote_currency:h,amount:Number(p),trade_date:ee.get("trade_date"),settlement_date_base:ee.get("settlement_date_base"),settlement_date_quote:ee.get("settlement_date_quote")};if(n==="BUY_SELL"){if(X.rate=Number(d),X.buy_rate=Number(d),X.sell_rate=Number(x),X.buy_counterparty_id=_?Number(_):void 0,X.sell_counterparty_id=f?Number(f):void 0,!_&&!f){alert("Please select at least one counterparty for the transaction.");return}}else if(X.rate=Number(b),n==="BUY"){if(!_){alert("Please select a counterparty for the BUY transaction.");return}X.counterparty_id=Number(_)}else if(n==="SELL"){if(!f){alert("Please select a counterparty for the SELL transaction.");return}X.counterparty_id=Number(f),P&&F&&(X.position_id=Number(F))}R.mutate(X)};return S.useEffect(()=>{i&&m(i==="AED"?"TOMAN":"AED")},[i]),T?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Trades"}),e.jsxs("button",{onClick:()=>t(!0),className:"btn btn-primary",children:[e.jsx($t,{className:"h-4 w-4 mr-2"}),"New Trade"]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(st,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search trades...",className:"form-input pl-10",value:r,onChange:w=>a(w.target.value)})]})}),e.jsxs("button",{className:"btn btn-secondary",children:[e.jsx(Ht,{className:"h-4 w-4 mr-2"}),"Filter"]})]})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"All Trades"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trade #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Currency Pair"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rate"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Counterparty"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Settlement Progress"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(Ee=V==null?void 0:V.data)==null?void 0:Ee.map(w=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:w.trade_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsx("span",{className:`badge ${w.trade_type==="BUY"?"badge-success":w.trade_type==="SELL"?"badge-danger":"badge-primary"}`,children:w.trade_type})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[w.base_currency,"/",w.quote_currency]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Z(w.amount,w.base_currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:w.rate.toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Z(w.total_value,w.quote_currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:w.counterparty_name||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${H(w)}`,children:Ne(w)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(Pe,{trade:w})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(w.trade_date).toLocaleDateString()})]},w.id))})]})})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-10 mx-auto p-5 border w-[600px] shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create New Trade"}),e.jsxs("form",{onSubmit:rt,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Trade Type"}),e.jsxs("select",{value:n,onChange:w=>l(w.target.value),className:"form-input",required:!0,children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"BUY",children:"Buy"}),e.jsx("option",{value:"SELL",children:"Sell"}),e.jsx("option",{value:"BUY_SELL",children:"Buy & Sell (Simultaneous)"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Base Currency"}),e.jsxs("select",{value:i,onChange:w=>o(w.target.value),className:"form-input",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"AED",children:"AED"}),e.jsx("option",{value:"TOMAN",children:"TOMAN"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Quote Currency"}),e.jsxs("select",{value:h,onChange:w=>m(w.target.value),className:"form-input",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"AED",children:"AED"}),e.jsx("option",{value:"TOMAN",children:"TOMAN"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Amount"}),e.jsx("input",{type:"number",value:p,onChange:w=>y(w.target.value),step:"0.01",className:"form-input",required:!0})]}),n==="SELL"&&e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-md",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Sell Options"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",checked:P,onChange:()=>z(!0),className:"mr-2"}),"Sell from existing positions"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",checked:!P,onChange:()=>z(!1),className:"mr-2"}),"Short sell (no existing position)"]})]}),P&&i&&e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Available ",i," positions: ",Z(Fe,i)]}),me.length>0?e.jsxs("select",{value:F,onChange:w=>M(w.target.value),className:"form-input",children:[e.jsx("option",{value:"",children:"Sell from all positions (FIFO)"}),me.map(w=>e.jsxs("option",{value:w.id,children:[w.trade_number," - ",Z(w.remaining_amount,w.currency)," @ ",w.average_cost_rate]},w.id))]}):e.jsxs("div",{className:"text-red-600 text-sm",children:["No ",i," positions available. Consider short selling instead."]})]})]})]}),n==="BUY_SELL"?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Buy Rate"}),e.jsx("input",{type:"number",value:d,onChange:w=>N(w.target.value),step:"0.000001",className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Sell Rate"}),e.jsx("input",{type:"number",value:x,onChange:w=>k(w.target.value),step:"0.000001",className:"form-input",required:!0})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Rate"}),e.jsx("input",{type:"number",value:b,onChange:w=>C(w.target.value),step:"0.000001",className:"form-input",required:!0})]}),n==="BUY_SELL"&&p&&d&&x&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-md",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2 flex items-center",children:[e.jsx(gt,{className:"h-4 w-4 mr-2"}),"Instant Profit Calculation"]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Buy Value:"}),e.jsx("span",{children:Z(parseFloat(p)*parseFloat(d),h)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Sell Value:"}),e.jsx("span",{children:Z(parseFloat(p)*parseFloat(x),h)})]}),e.jsxs("div",{className:"flex justify-between font-bold border-t pt-1",children:[e.jsx("span",{children:"Profit/Loss:"}),e.jsxs("span",{className:`${ge()>=0?"text-green-600":"text-red-600"}`,children:[ge()>=0?"+":"",Z(ge(),h)]})]})]})]}),n==="BUY_SELL"?e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Buy From (Seller)"}),e.jsxs("select",{value:_,onChange:w=>v(w.target.value),className:"form-input",children:[e.jsx("option",{value:"",children:"Select seller"}),Q==null?void 0:Q.map(w=>e.jsx("option",{value:w.id,children:w.name},w.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Sell To (Buyer)"}),e.jsxs("select",{value:f,onChange:w=>D(w.target.value),className:"form-input",children:[e.jsx("option",{value:"",children:"Select buyer"}),Q==null?void 0:Q.map(w=>e.jsx("option",{value:w.id,children:w.name},w.id))]})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:n==="BUY"?"Buy From (Seller)":"Sell To (Buyer)"}),e.jsxs("select",{value:n==="BUY"?_:f,onChange:w=>{n==="BUY"?v(w.target.value):D(w.target.value)},className:"form-input",children:[e.jsx("option",{value:"",children:"Select counterparty"}),Q==null?void 0:Q.map(w=>e.jsx("option",{value:w.id,children:w.name},w.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Trade Date"}),e.jsx("input",{type:"date",name:"trade_date",className:"form-input",defaultValue:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Settlement Date (Base)"}),e.jsx("input",{type:"date",name:"settlement_date_base",className:"form-input",defaultValue:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Settlement Date (Quote)"}),e.jsx("input",{type:"date",name:"settlement_date_quote",className:"form-input",defaultValue:new Date().toISOString().split("T")[0],required:!0})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{t(!1),I()},className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:R.isPending,className:"btn btn-primary",children:R.isPending?"Creating...":"Create Trade"})]})]})]})})})]})}function Tl(){const[s,t]=S.useState(!1),[r,a]=S.useState(null),[n,l]=S.useState(""),[i,o]=S.useState(""),h=jt(),{data:m,isLoading:p}=ie({queryKey:["positions"],queryFn:()=>J.get("/trades/positions/outstanding").then(v=>v.data.data)}),{data:y}=ie({queryKey:["parties"],queryFn:()=>J.get("/parties").then(v=>v.data.data)}),b=_e({mutationFn:v=>J.post("/trades/positions/sell",v),onSuccess:()=>{h.invalidateQueries({queryKey:["positions"]}),h.invalidateQueries({queryKey:["trades"]}),h.invalidateQueries({queryKey:["dashboard"]}),t(!1),a(null),l(""),o("")}}),C=(v,f)=>new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(v)+` ${f}`,d=()=>{if(!r||!n||!i)return 0;const v=parseFloat(n),f=parseFloat(i);if(isNaN(v)||isNaN(f))return 0;const D=v*f,P=v*r.average_cost_rate;return D-P},N=v=>{a(v),l(v.remaining_amount.toString()),t(!0)},x=v=>{if(v.preventDefault(),!r)return;const f=new FormData(v.currentTarget),D=f.get("counterparty_id");if(!D){alert("Please select a counterparty for the position sale.");return}const P=new Date().toISOString().split("T")[0],z={position_id:r.id,amount:parseFloat(f.get("amount")),rate:parseFloat(f.get("rate")),counterparty_id:parseInt(D),settlement_date_base:f.get("settlement_date_base")||P,settlement_date_quote:f.get("settlement_date_quote")||P};b.mutate(z)};if(p)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})});const k=(m==null?void 0:m.filter(v=>v.currency==="AED").reduce((v,f)=>v+f.remaining_amount,0))||0,_=(m==null?void 0:m.filter(v=>v.currency==="TOMAN").reduce((v,f)=>v+f.remaining_amount,0))||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Outstanding Positions"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(nr,{className:"h-8 w-8 text-primary-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Total Positions"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(m==null?void 0:m.length)||0})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(tt,{className:"h-8 w-8 text-success-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"AED Positions"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:C(k,"AED")})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(gt,{className:"h-8 w-8 text-warning-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"TOMAN Positions"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:C(_,"TOMAN")})]})]})})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"All Outstanding Positions"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Original Trade"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Currency"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Original Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Remaining Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Average Cost Rate"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Trade Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m==null?void 0:m.map(v=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:v.trade_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsx("span",{className:`badge ${v.currency==="AED"?"badge-success":"badge-warning"}`,children:v.currency})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C(v.original_amount,v.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:C(v.remaining_amount,v.currency)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:v.average_cost_rate.toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(v.trade_date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("button",{onClick:()=>N(v),className:"btn btn-primary btn-sm",children:"Sell from Position"})})]},v.id))})]})})]}),s&&r&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-[500px] shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Sell from Position: ",r.trade_number]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-md mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Currency:"}),e.jsx("span",{className:"ml-2 font-medium",children:r.currency})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Available:"}),e.jsx("span",{className:"ml-2 font-medium",children:C(r.remaining_amount,r.currency)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Avg Cost:"}),e.jsx("span",{className:"ml-2 font-medium",children:r.average_cost_rate.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Trade Date:"}),e.jsx("span",{className:"ml-2 font-medium",children:new Date(r.trade_date).toLocaleDateString()})]})]})}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Amount to Sell *"}),e.jsx("input",{type:"number",name:"amount",step:"0.01",max:r.remaining_amount,value:n,onChange:v=>l(v.target.value),className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Sale Rate *"}),e.jsx("input",{type:"number",name:"rate",step:"0.000001",value:i,onChange:v=>o(v.target.value),className:"form-input",required:!0})]})]}),n&&i&&e.jsx("div",{className:"bg-blue-50 p-4 rounded-md",children:e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{children:"Sale Value:"}),e.jsx("span",{className:"font-medium",children:C(parseFloat(n)*parseFloat(i),r.currency==="AED"?"TOMAN":"AED")})]}),e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{children:"Cost Basis:"}),e.jsx("span",{className:"font-medium",children:C(parseFloat(n)*r.average_cost_rate,r.currency==="AED"?"TOMAN":"AED")})]}),e.jsxs("div",{className:"flex justify-between font-bold border-t pt-1",children:[e.jsx("span",{children:"Profit/Loss:"}),e.jsxs("span",{className:`${d()>=0?"text-green-600":"text-red-600"}`,children:[d()>=0?"+":"",C(d(),r.currency==="AED"?"TOMAN":"AED")]})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Counterparty *"}),e.jsxs("select",{name:"counterparty_id",className:"form-input",required:!0,children:[e.jsx("option",{value:"",children:"Select counterparty"}),y==null?void 0:y.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Settlement Date (Base)"}),e.jsx("input",{type:"date",name:"settlement_date_base",className:"form-input",defaultValue:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Settlement Date (Quote)"}),e.jsx("input",{type:"date",name:"settlement_date_quote",className:"form-input",defaultValue:new Date().toISOString().split("T")[0],required:!0})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:b.isPending,className:"btn btn-primary flex-1",children:b.isPending?"Selling...":"Sell Position"}),e.jsx("button",{type:"button",onClick:()=>{t(!1),a(null),l(""),o("")},className:"btn btn-secondary flex-1",children:"Cancel"})]})]})]})})})]})}function Dl(){var q;const[s,t]=S.useState(""),[r,a]=S.useState("ALL"),[n,l]=S.useState("ALL"),[i,o]=S.useState(!1),[h,m]=S.useState(null),[p,y]=S.useState(!1),[b,C]=S.useState(null),[d,N]=S.useState({payerId:"",trackingSearch:"",startDate:"",endDate:""}),[x,k]=S.useState(!1),[_,v]=S.useState(null),[f,D]=S.useState(""),[P,z]=S.useState(""),[F,M]=S.useState({account_number:"",bank_name:"",currency:"TOMAN",counterpart_id:0,is_active:!0}),K=jt(),{data:V}=ie({queryKey:["accounts"],queryFn:async()=>(await J.get("/accounts")).data.data}),{data:T}=ie({queryKey:["parties"],queryFn:async()=>(await J.get("/parties")).data.data}),Q=_e({mutationFn:async u=>(await J.post("/accounts",u)).data,onSuccess:()=>{K.invalidateQueries({queryKey:["accounts"]}),w(),o(!1)}}),E=_e({mutationFn:async({id:u,data:A})=>(await J.put(`/accounts/${u}`,A)).data,onSuccess:()=>{K.invalidateQueries({queryKey:["accounts"]}),w(),o(!1)}}),R=_e({mutationFn:async u=>(await J.delete(`/accounts/${u}`)).data,onSuccess:()=>{K.invalidateQueries({queryKey:["accounts"]})}}),I=async u=>{try{await Z(u),y(!0)}catch(A){console.error("Failed to fetch receipts:",A)}},Z=async u=>{const A=new URLSearchParams;d.payerId&&A.append("payer_id",d.payerId),d.trackingSearch&&A.append("tracking_search",d.trackingSearch),d.startDate&&A.append("start_date",d.startDate),d.endDate&&A.append("end_date",d.endDate);const G=A.toString(),ae=await J.get(`/accounts/${u.id}${G?`?${G}`:""}`);C(ae.data.data)},H=async()=>{if(b)try{const u=new URLSearchParams({format:"csv"});d.payerId&&u.append("payer_id",d.payerId),d.trackingSearch&&u.append("tracking_search",d.trackingSearch),d.startDate&&u.append("start_date",d.startDate),d.endDate&&u.append("end_date",d.endDate);const G=await(await fetch(`/api/accounts/${b.account.id}?${u.toString()}`)).blob(),ae=window.URL.createObjectURL(G),ne=document.createElement("a");ne.style.display="none",ne.href=ae,ne.download=`${b.account.bank_name}-receipts.csv`,document.body.appendChild(ne),ne.click(),window.URL.revokeObjectURL(ae),document.body.removeChild(ne)}catch(u){console.error("Failed to export CSV:",u),alert("Failed to export CSV")}};S.useEffect(()=>{if(!b)return;const u=setTimeout(()=>{Z(b.account)},300);return()=>clearTimeout(u)},[d.trackingSearch]),S.useEffect(()=>{b&&Z(b.account)},[d.payerId,d.startDate,d.endDate]);const Ne=u=>{N(A=>({...A,[u]:""}))},Pe=u=>{!f||_==="start"?(D(u),z(""),v("end")):(u<f?N(A=>({...A,startDate:u,endDate:f})):N(A=>({...A,startDate:f,endDate:u})),k(!1),v(null),D(""),z(""))},ge=()=>{D(d.startDate),z(d.endDate),v(d.startDate?"end":"start"),k(!0)},me=()=>{N(u=>({...u,startDate:"",endDate:""})),k(!1),v(null),D(""),z("")},Fe=u=>f?!P&&_==="end"?u>=f:u>=f&&u<=P:!1,rt=()=>{const u=new Date,A=u.getFullYear(),G=u.getMonth(),ae=new Date(A,G,1),ne=new Date(ae);ne.setDate(ne.getDate()-ae.getDay());const Le=[],be=new Date(ne);for(let Zt=0;Zt<6;Zt++)for(let es=0;es<7;es++)Le.push(new Date(be)),be.setDate(be.getDate()+1);return Le},Ee=[d.payerId,d.trackingSearch,d.startDate].filter(Boolean).length,w=()=>{M({account_number:"",bank_name:"",currency:"TOMAN",counterpart_id:0,is_active:!0}),m(null)},ee=u=>{if(u.preventDefault(),F.counterpart_id===0){alert("Please select a counterpart");return}h?E.mutate({id:h.id,data:F}):Q.mutate(F)},X=u=>{M({account_number:u.account_number,bank_name:u.bank_name,currency:u.currency,counterpart_id:u.counterpart_id,is_active:u.is_active}),m(u),o(!0)},le=u=>{confirm("Are you sure you want to delete this bank account?")&&R.mutate(u)},at=u=>{E.mutate({id:u.id,data:{is_active:!u.is_active}})},Se=(V||[]).filter(u=>{const A=u.account_number.toLowerCase().includes(s.toLowerCase())||u.bank_name.toLowerCase().includes(s.toLowerCase())||(u.counterpart_name||"").toLowerCase().includes(s.toLowerCase()),G=r==="ALL"||u.currency===r,ae=n==="ALL"||n==="ACTIVE"&&u.is_active||n==="INACTIVE"&&!u.is_active;return A&&G&&ae}),Nt=Se.filter(u=>u.is_active),vt=Se.filter(u=>!u.is_active),j=[...Nt,...vt];return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Bank Accounts"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage counterpart-linked bank accounts for payment processing"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-6 py-3 rounded-xl font-medium shadow-lg hover:shadow-xl transition-all duration-200 flex items-center space-x-2",children:[e.jsx($t,{className:"h-5 w-5"}),e.jsx("span",{children:"Add Account"})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(st,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search accounts...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",value:s,onChange:u=>t(u.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Currency"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",value:r,onChange:u=>a(u.target.value),children:[e.jsx("option",{value:"ALL",children:"All Currencies"}),e.jsx("option",{value:"AED",children:"AED"}),e.jsx("option",{value:"TOMAN",children:"TOMAN"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",value:n,onChange:u=>l(u.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:()=>{t(""),a("ALL"),l("ALL")},className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Ht,{className:"h-4 w-4"}),e.jsx("span",{children:"Clear"})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(wt,{className:"h-6 w-6 text-blue-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Accounts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(V==null?void 0:V.length)||0})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Hn,{className:"h-6 w-6 text-green-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(V==null?void 0:V.filter(u=>u.is_active).length)||0})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx(wr,{className:"h-6 w-6 text-yellow-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"AED Accounts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(V==null?void 0:V.filter(u=>u.currency==="AED").length)||0})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(Sr,{className:"h-6 w-6 text-purple-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"TOMAN Accounts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(V==null?void 0:V.filter(u=>u.currency==="TOMAN").length)||0})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Bank Accounts"})}),j.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(wt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s||r!=="ALL"||n!=="ALL"?"No accounts match your filters":"No bank accounts found"}),e.jsx("p",{className:"text-gray-600",children:!s&&r==="ALL"&&n==="ALL"&&"Get started by adding your first bank account"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 p-6",children:j.map(u=>e.jsxs("div",{className:`border rounded-lg p-6 transition-all duration-200 ${u.is_active?"border-gray-200 hover:shadow-md bg-white":"border-gray-200 bg-gray-50 opacity-75"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${u.currency==="AED"?"bg-green-100":"bg-purple-100"}`,children:e.jsx(wt,{className:`h-5 w-5 ${u.currency==="AED"?"text-green-600":"text-purple-600"}`})}),e.jsxs("div",{children:[e.jsx("div",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${u.currency==="AED"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:u.currency}),!u.is_active&&e.jsx("div",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800 ml-2",children:"Inactive"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"text-gray-400 hover:text-gray-600 p-1",onClick:()=>{const A=document.getElementById(`dropdown-${u.id}`);A==null||A.classList.toggle("hidden")},children:e.jsx(ir,{className:"h-4 w-4"})}),e.jsxs("div",{id:`dropdown-${u.id}`,className:"hidden absolute right-0 top-8 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10",children:[e.jsx("button",{onClick:()=>{var A;X(u),(A=document.getElementById(`dropdown-${u.id}`))==null||A.classList.add("hidden")},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-t-lg",children:"Edit Account"}),e.jsxs("button",{onClick:()=>{var A;I(u),(A=document.getElementById(`dropdown-${u.id}`))==null||A.classList.add("hidden")},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:["View Receipts (",u.receipt_count||0,")"]}),e.jsx("button",{onClick:()=>{var A;at(u),(A=document.getElementById(`dropdown-${u.id}`))==null||A.classList.add("hidden")},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:u.is_active?"Deactivate":"Activate"}),e.jsx("button",{onClick:()=>{var A;le(u.id),(A=document.getElementById(`dropdown-${u.id}`))==null||A.classList.add("hidden")},className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-b-lg",children:"Delete"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900",children:u.bank_name}),e.jsx("p",{className:"text-sm text-gray-600 font-mono",children:u.account_number})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:u.counterpart_name})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(vr,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-xs text-gray-600",children:[u.receipt_count||0," receipts"]})]}),e.jsxs("button",{onClick:()=>I(u),className:"text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center space-x-1",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{children:"View"})]})]})]})]},u.id))})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:h?"Edit Account":"Add New Account"}),e.jsx("p",{className:"text-gray-600 mt-1",children:h?"Update account details":"Create a counterpart-linked bank account"})]}),e.jsx("button",{onClick:()=>{w(),o(!1)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ie,{className:"h-6 w-6"})})]})}),e.jsxs("form",{onSubmit:ee,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Sr,{className:"h-4 w-4 inline mr-1"}),"Account Number *"]}),e.jsx("input",{type:"text",placeholder:"Enter account number",className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500 focus:border-transparent",value:F.account_number,onChange:u=>M({...F,account_number:u.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(vr,{className:"h-4 w-4 inline mr-1"}),"Bank Name *"]}),e.jsx("input",{type:"text",placeholder:"Enter bank name",className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500 focus:border-transparent",value:F.bank_name,onChange:u=>M({...F,bank_name:u.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(wr,{className:"h-4 w-4 inline mr-1"}),"Currency *"]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500 focus:border-transparent",value:F.currency,onChange:u=>M({...F,currency:u.target.value}),required:!0,children:[e.jsx("option",{value:"TOMAN",children:"TOMAN"}),e.jsx("option",{value:"AED",children:"AED"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(fs,{className:"h-4 w-4 inline mr-1"}),"Counterpart *"]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-green-500 focus:border-transparent",value:F.counterpart_id,onChange:u=>M({...F,counterpart_id:parseInt(u.target.value)}),required:!0,children:[e.jsx("option",{value:0,children:"Select a counterpart"}),(T||[]).map(u=>e.jsx("option",{value:u.id,children:u.name},u.id))]})]}),h&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"is_active",className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500",checked:F.is_active,onChange:u=>M({...F,is_active:u.target.checked})}),e.jsx("label",{htmlFor:"is_active",className:"text-sm font-medium text-gray-700",children:"Account is active"})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>{w(),o(!1)},children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50",disabled:Q.isPending||E.isPending,children:Q.isPending||E.isPending?"Saving...":"Save Account"})]})]})]})}),p&&b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Receipt History"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[b.account.bank_name," - ...",b.account.account_number.slice(-5)]})]}),e.jsx("button",{onClick:()=>{y(!1),C(null),N({payerId:"",trackingSearch:"",startDate:"",endDate:""}),v(null)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ie,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(Ht,{className:"h-5 w-5 mr-2"}),"Filters ",Ee>0&&e.jsx("span",{className:"ml-2 bg-blue-100 text-blue-600 text-xs px-2 py-1 rounded-full",children:Ee})]}),e.jsx("button",{onClick:H,className:"p-2 text-green-600 hover:text-green-700 hover:bg-green-50 rounded-lg transition-all duration-200",title:"Export to CSV",children:e.jsx(ma,{className:"h-5 w-5"})})]}),Ee>0&&e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[d.payerId&&e.jsxs("div",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm flex items-center space-x-2",children:[e.jsxs("span",{children:["Payer: ",(q=T==null?void 0:T.find(u=>u.id==d.payerId))==null?void 0:q.name]}),e.jsx("button",{onClick:()=>Ne("payerId"),className:"text-blue-600 hover:text-blue-800",children:e.jsx(Ie,{className:"h-3 w-3"})})]}),d.trackingSearch&&e.jsxs("div",{className:"bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm flex items-center space-x-2",children:[e.jsxs("span",{children:["Tracking: ",d.trackingSearch]}),e.jsx("button",{onClick:()=>Ne("trackingSearch"),className:"text-purple-600 hover:text-purple-800",children:e.jsx(Ie,{className:"h-3 w-3"})})]}),d.startDate&&e.jsxs("div",{className:"bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm flex items-center space-x-2",children:[e.jsx("span",{children:d.endDate?`${d.startDate} to ${d.endDate}`:`From ${d.startDate}`}),e.jsx("button",{onClick:me,className:"text-orange-600 hover:text-orange-800",children:e.jsx(Ie,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payer"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",value:d.payerId,onChange:u=>N({...d,payerId:u.target.value}),children:[e.jsx("option",{value:"",children:"All Payers"}),T&&T.map(u=>e.jsx("option",{value:u.id,children:u.name},u.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tracking Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(st,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search tracking...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",value:d.trackingSearch,onChange:u=>N({...d,trackingSearch:u.target.value})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Date Range",_==="end"&&e.jsx("span",{className:"text-xs text-blue-600 ml-1",children:"(select end date)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ds,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("button",{type:"button",onClick:ge,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-left bg-white hover:bg-gray-50",children:d.startDate&&d.endDate?`${d.startDate} to ${d.endDate}`:d.startDate?`From ${d.startDate}`:"Select date range"}),x&&e.jsxs("div",{className:"absolute z-50 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg p-4 w-64",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:_==="start"?"Select start date":"Select end date"})}),e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(u=>e.jsx("div",{className:"text-xs font-medium text-gray-500 text-center p-1",children:u},u))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:rt().map((u,A)=>{const G=`${u.getFullYear()}-${String(u.getMonth()+1).padStart(2,"0")}-${String(u.getDate()).padStart(2,"0")}`,ae=u.getMonth()===new Date().getMonth(),ne=G===f||G===P,Le=Fe(G),be=new Date,Zt=`${be.getFullYear()}-${String(be.getMonth()+1).padStart(2,"0")}-${String(be.getDate()).padStart(2,"0")}`,es=G===Zt;return e.jsx("button",{type:"button",onClick:()=>Pe(G),onMouseEnter:()=>{_==="end"&&f&&z(G)},className:`
                                  p-1 text-xs rounded transition-colors
                                  ${ae?"":"text-gray-300"}
                                  ${es?"ring-1 ring-blue-500":""}
                                  ${ne?"bg-blue-600 text-white":""}
                                  ${Le&&!ne?"bg-blue-100 text-blue-700":""}
                                  ${ae&&!ne&&!Le?"hover:bg-gray-100":""}
                                `,children:u.getDate()},A)})}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("button",{type:"button",onClick:me,className:"text-xs text-gray-500 hover:text-gray-700",children:"Clear"}),e.jsx("button",{type:"button",onClick:()=>k(!1),className:"text-xs text-gray-500 hover:text-gray-700",children:"Close"})]})]})]})]})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Owner:"}),e.jsx("span",{className:"ml-2 font-medium",children:b.account.counterpart_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Currency:"}),e.jsx("span",{className:"ml-2 font-medium",children:b.account.currency})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:"ml-2 font-medium",children:b.account.is_active?"Active":"Inactive"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Filtered Receipts:"}),e.jsx("span",{className:"ml-2 font-medium",children:b.receipts.length})]})]})}),b.receipts.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(wt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"No receipts found"}),e.jsx("p",{className:"text-gray-600",children:d.payerId||d.trackingSearch||d.startDate||d.endDate?"No receipts match your current filters":"This account hasn't received any payments yet"})]}):e.jsx("div",{className:"space-y-4",children:b.receipts.map(u=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:["Receipt #",u.id]}),e.jsx("p",{className:"text-sm text-gray-600",children:new Date(u.receipt_date).toLocaleDateString()})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-bold text-lg text-green-600",children:[u.amount.toLocaleString()," ",u.currency||"TOMAN"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Payer:"}),e.jsx("span",{className:"ml-2 font-medium",children:u.payer_name||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Tracking:"}),e.jsxs("span",{className:"ml-2 font-mono bg-gray-100 px-2 py-1 rounded",children:["...",u.tracking_last_5]})]})]}),u.notes&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:e.jsx("p",{className:"text-sm text-gray-700",children:u.notes})})]},u.id))}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 flex justify-between",children:e.jsx("button",{onClick:()=>{y(!1),C(null),N({payerId:"",trackingSearch:"",startDate:"",endDate:""}),v(null)},className:"px-6 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors",children:"Close"})})]})]})})]})}function Rl(){const[s,t]=S.useState(!1),[r,a]=S.useState(null),[n,l]=S.useState(""),i=jt(),{data:o,isLoading:h}=ie({queryKey:["parties"],queryFn:()=>J.get("/parties").then(x=>x.data.data)}),m=_e({mutationFn:x=>J.post("/parties",x),onSuccess:()=>{i.invalidateQueries({queryKey:["parties"]}),t(!1),a(null)}}),p=_e({mutationFn:({id:x,...k})=>J.put(`/parties/${x}`,k),onSuccess:()=>{i.invalidateQueries({queryKey:["parties"]}),t(!1),a(null)}}),y=_e({mutationFn:x=>J.delete(`/parties/${x}`),onSuccess:()=>{i.invalidateQueries({queryKey:["parties"]})}}),b=x=>{x.preventDefault();const k=new FormData(x.currentTarget),_={name:k.get("name"),phone:k.get("phone")||void 0,email:k.get("email")||void 0,national_id:k.get("national_id")||void 0,notes:k.get("notes")||void 0};r?p.mutate({id:r.id,..._}):m.mutate(_)},C=x=>{a(x),t(!0)},d=x=>{window.confirm(`Are you sure you want to delete "${x.name}"?`)&&y.mutate(x.id)},N=(o==null?void 0:o.filter(x=>{var k,_,v;return x.name.toLowerCase().includes(n.toLowerCase())||((k=x.phone)==null?void 0:k.includes(n))||((_=x.email)==null?void 0:_.toLowerCase().includes(n.toLowerCase()))||((v=x.national_id)==null?void 0:v.includes(n))}))||[];return h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Trading Parties"}),e.jsxs("button",{onClick:()=>{a(null),t(!0)},className:"btn btn-primary",children:[e.jsx($t,{className:"h-4 w-4 mr-2"}),"Add Trading Party"]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"relative",children:[e.jsx(st,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name, phone, email, or ID...",className:"form-input pl-10",value:n,onChange:x=>l(x.target.value)})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(kr,{className:"h-8 w-8 text-primary-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Total Parties"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(o==null?void 0:o.length)||0})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Cr,{className:"h-8 w-8 text-success-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"With Email"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(o==null?void 0:o.filter(x=>x.email).length)||0})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(fs,{className:"h-8 w-8 text-warning-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"With National ID"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(o==null?void 0:o.filter(x=>x.national_id).length)||0})]})]})})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"All Trading Parties"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"National ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Notes"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(x=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:x.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[x.phone&&e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(kr,{className:"h-3 w-3 mr-1 text-gray-400"}),x.phone]}),x.email&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(Cr,{className:"h-3 w-3 mr-1 text-gray-400"}),x.email]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:x.national_id||"-"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:x.notes||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(x.created_at).toLocaleDateString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>C(x),className:"text-primary-600 hover:text-primary-700",children:e.jsx(ir,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>d(x),className:"text-danger-600 hover:text-danger-700",children:e.jsx(xa,{className:"h-4 w-4"})})]})]},x.id))})]})})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:r?"Edit Trading Party":"Add New Trading Party"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Name *"}),e.jsx("input",{type:"text",name:"name",required:!0,defaultValue:(r==null?void 0:r.name)||"",className:"form-input",placeholder:"Trading party name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",defaultValue:(r==null?void 0:r.phone)||"",className:"form-input",placeholder:"Phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",name:"email",defaultValue:(r==null?void 0:r.email)||"",className:"form-input",placeholder:"Email address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"National ID"}),e.jsx("input",{type:"text",name:"national_id",defaultValue:(r==null?void 0:r.national_id)||"",className:"form-input",placeholder:"National ID number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{name:"notes",rows:3,defaultValue:(r==null?void 0:r.notes)||"",className:"form-input",placeholder:"Additional notes..."})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:m.isPending||p.isPending,className:"btn btn-primary flex-1",children:m.isPending||p.isPending?"Saving...":r?"Update":"Create"}),e.jsx("button",{type:"button",onClick:()=>{t(!1),a(null)},className:"btn btn-secondary flex-1",children:"Cancel"})]})]})]})})})]})}function Ol(){const[s,t]=S.useState(""),[r,a]=S.useState(!1),[n,l]=S.useState(null),[i,o]=S.useState("TOMAN"),[h,m]=S.useState("ALL"),[p,y]=S.useState(""),[b,C]=S.useState(!1),[d,N]=S.useState({payer_id:0,receiver_account_id:0,tracking_last_5:"",amount:"",receipt_date:new Date().toISOString().split("T")[0],notes:"",receipt_type:"pay",trading_party_id:0,individual_name:""}),[x,k]=S.useState(!1),[_,v]=S.useState(null),[f,D]=S.useState(""),[P,z]=S.useState("duplicate"),[F,M]=S.useState("active"),[K,V]=S.useState(!1),[T,Q]=S.useState(null),[E,R]=S.useState(""),I=jt(),{data:Z}=ie({queryKey:["receipts",F],queryFn:()=>{const j=new URLSearchParams;F==="archived"&&j.append("only_deleted","true");const q=j.toString();return J.get(`/receipts${q?`?${q}`:""}`).then(u=>u.data.data)}}),{data:H}=ie({queryKey:["parties"],queryFn:async()=>(await J.get("/parties")).data.data}),{data:Ne}=ie({queryKey:["accounts","active"],queryFn:async()=>(await J.get("/accounts?active=true")).data.data}),Pe=_e({mutationFn:async j=>(await J.post("/receipts",j)).data,onSuccess:()=>{I.invalidateQueries({queryKey:["receipts"]}),I.invalidateQueries({queryKey:["dashboard"]}),I.invalidateQueries({queryKey:["trades"]}),a(!1),Fe(),alert("Receipt created successfully!")},onError:j=>{var u,A;console.error("Error creating receipt:",j);const q=((A=(u=j.response)==null?void 0:u.data)==null?void 0:A.error)||j.message||"Unknown error occurred";alert(`Failed to create receipt: ${q}`)}}),ge=_e({mutationFn:({receiptId:j,reason:q,reasonCategory:u})=>J.put(`/receipts/${j}/delete`,{reason:q,reason_category:u,deleted_by:"User"}),onSuccess:()=>{I.invalidateQueries({queryKey:["receipts"]}),I.invalidateQueries({queryKey:["dashboard"]}),I.invalidateQueries({queryKey:["counterparts"]}),I.invalidateQueries({queryKey:["trades"]}),k(!1),v(null),D(""),z("duplicate")}}),me=_e({mutationFn:({receiptId:j,reason:q})=>J.put(`/receipts/${j}/restore`,{reason:q,restored_by:"User"}),onSuccess:()=>{I.invalidateQueries({queryKey:["receipts"]}),I.invalidateQueries({queryKey:["dashboard"]}),I.invalidateQueries({queryKey:["counterparts"]}),I.invalidateQueries({queryKey:["trades"]}),V(!1),Q(null),R("")}}),Fe=()=>{N({payer_id:0,receiver_account_id:0,tracking_last_5:"",amount:"",receipt_date:new Date().toISOString().split("T")[0],notes:"",receipt_type:"pay",trading_party_id:0,individual_name:""}),y(""),C(!1)},rt=j=>{if(j.preventDefault(),i==="TOMAN"){if(d.payer_id===0){alert("Please select a payer");return}if(d.receiver_account_id===0){alert("Please select a receiver account");return}}else{if(d.trading_party_id===0){alert("Please select a trading party");return}if(!d.individual_name.trim()){alert("Please enter the individual name");return}}let u={tracking_last_5:Math.floor(1e4+Math.random()*9e4).toString(),amount:Number(d.amount.replace(/,/g,"")),currency:i,receipt_date:d.receipt_date,notes:d.notes};i==="TOMAN"?(u.payer_id=d.payer_id,u.receiver_account_id=d.receiver_account_id):(u.receipt_type=d.receipt_type,u.trading_party_id=d.trading_party_id,u.individual_name=d.individual_name),Pe.mutate(u)},Ee=j=>{v(j),k(!0)},w=()=>{if(!_||!f.trim()){alert("Please provide a reason for deletion");return}ge.mutate({receiptId:_.id,reason:f,reasonCategory:P})},ee=j=>{Q(j),V(!0)},X=()=>{if(!T||!E.trim()){alert("Please provide a reason for restoration");return}me.mutate({receiptId:T.id,reason:E})},le=j=>j.toLocaleString(),at=(Z||[]).filter(j=>{const q=(j.payer_name||"").toLowerCase().includes(s.toLowerCase())||j.tracking_last_5.includes(s)||(j.receiver_bank_name||"").toLowerCase().includes(s.toLowerCase())||(j.receiver_counterpart_name||"").toLowerCase().includes(s.toLowerCase())||(j.individual_name||"").toLowerCase().includes(s.toLowerCase()),u=h==="ALL"||h==="TOMAN"&&(!j.currency||j.currency==="TOMAN")||h==="AED"&&j.currency==="AED";return q&&u}),Se=Ne==null?void 0:Ne.find(j=>j.id===d.receiver_account_id),Nt=(Z||[]).filter(j=>!j.currency||j.currency==="TOMAN"),vt=(Z||[]).filter(j=>j.currency==="AED");return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto p-6 space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Payment Receipts"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track and manage TOMAN & AED payment receipts with automatic balance updates"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>M("active"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${F==="active"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(St,{className:"h-4 w-4 mr-2 inline"}),"Active"]}),e.jsxs("button",{onClick:()=>M("archived"),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${F==="archived"?"bg-white text-red-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(_s,{className:"h-4 w-4 mr-2 inline"}),"Archived"]})]}),e.jsxs("button",{onClick:()=>a(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-6 py-3 rounded-xl font-medium shadow-lg hover:shadow-xl transition-all duration-200 flex items-center space-x-2",disabled:F==="archived",children:[e.jsx($t,{className:"h-5 w-5"}),e.jsx("span",{children:"Add Receipt"})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(st,{className:"h-5 w-5 absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by payer, tracking number, bank, counterpart, or individual...",className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:s,onChange:j=>t(j.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ht,{className:"h-5 w-5 text-gray-400"}),e.jsxs("select",{className:"border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent min-w-[120px]",value:h,onChange:j=>m(j.target.value),children:[e.jsx("option",{value:"ALL",children:"All Currency"}),e.jsx("option",{value:"TOMAN",children:"TOMAN Only"}),e.jsx("option",{value:"AED",children:"AED Only"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(St,{className:"h-6 w-6 text-blue-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Receipts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(Z==null?void 0:Z.length)||0})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Fn,{className:"h-6 w-6 text-green-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"TOMAN Total"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900",children:[le(Nt.reduce((j,q)=>j+q.amount,0)),e.jsx("span",{className:"text-sm font-medium text-gray-600 ml-1",children:"T"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center",children:e.jsx(tt,{className:"h-6 w-6 text-yellow-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"AED Total"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900",children:[le(vt.reduce((j,q)=>j+q.amount,0)),e.jsx("span",{className:"text-sm font-medium text-gray-600 ml-1",children:"AED"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(je,{className:"h-6 w-6 text-purple-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Parties"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:new Set((Z==null?void 0:Z.map(j=>j.payer_id||j.trading_party_id))||[]).size})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:F==="active"?"Active Receipts":"Archived Receipts"})}),at.length===0?e.jsx("div",{className:"text-center py-12",children:F==="active"?e.jsxs(e.Fragment,{children:[e.jsx(St,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s?"No receipts match your search":"No active receipts found"}),e.jsx("p",{className:"text-gray-600",children:!s&&"Get started by adding your first receipt"})]}):e.jsxs(e.Fragment,{children:[e.jsx(_s,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s?"No archived receipts match your search":"No archived receipts"}),e.jsx("p",{className:"text-gray-600",children:"Deleted receipts will appear here and can be restored if needed"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 p-6",children:at.map(j=>e.jsxs("div",{className:`border-2 rounded-lg p-5 hover:shadow-md transition-shadow duration-200 ${j.currency==="AED"?"border-yellow-200 bg-yellow-50":"border-blue-200 bg-blue-50"} ${F==="archived"?"opacity-75 border-dashed":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${j.currency==="AED"?"bg-yellow-100":"bg-blue-100"}`,children:F==="archived"?e.jsx(_s,{className:`h-4 w-4 ${j.currency==="AED"?"text-yellow-600":"text-blue-600"}`}):e.jsx(St,{className:`h-4 w-4 ${j.currency==="AED"?"text-yellow-600":"text-blue-600"}`})}),e.jsxs("span",{className:"font-medium text-gray-900",children:["#",j.id]}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${j.currency==="AED"?"bg-yellow-200 text-yellow-800":"bg-blue-200 text-blue-800"}`,children:j.currency||"TOMAN"}),F==="archived"&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800",children:"ARCHIVED"})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(j.receipt_date).toLocaleDateString()})]}),e.jsxs("div",{className:"space-y-3",children:[F==="archived"&&j.deleted_at&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-3 mb-3",children:[e.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["Deleted: ",new Date(j.deleted_at).toLocaleDateString()]}),j.deletion_reason&&e.jsxs("p",{className:"text-xs text-red-700 mt-1",children:[j.deletion_reason_category,": ",j.deletion_reason]}),j.restored_at&&e.jsxs("p",{className:"text-xs text-green-700 mt-1 font-medium",children:[" Restored: ",new Date(j.restored_at).toLocaleDateString()]})]}),j.currency==="AED"?e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Receipt Type"}),e.jsx("p",{className:"font-medium text-gray-900 capitalize",children:j.receipt_type==="pay"?`Agrivex  ${j.trading_party_name||"Unknown"}`:`${j.trading_party_name||"Unknown"}  Agrivex`})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Payer"}),e.jsx("p",{className:"font-medium text-gray-900",children:j.payer_name||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Receiver"}),e.jsx("p",{className:"font-medium text-gray-900",children:j.receiver_counterpart_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[j.receiver_bank_name,j.receiver_account_number&&e.jsxs("span",{className:"ml-1 font-mono text-xs bg-gray-100 px-1 py-0.5 rounded",children:["...",j.receiver_account_number.slice(-5)]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:j.currency==="AED"?"Reference":"Tracking"}),e.jsxs("p",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:["...",j.tracking_last_5]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Amount"}),e.jsxs("p",{className:`font-bold text-lg ${j.currency==="AED"?"text-yellow-600":"text-green-600"}`,children:[le(j.amount),e.jsx("span",{className:"text-sm font-medium text-gray-600 ml-1",children:j.currency==="AED"?"AED":"T"})]})]})]}),j.notes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-700",children:j.notes})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 flex justify-between items-center",children:[e.jsxs("button",{onClick:()=>l(j),className:"text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center space-x-1",children:[e.jsx(Ct,{className:"h-4 w-4"}),e.jsx("span",{children:"View Details"})]}),F==="active"?e.jsx("button",{onClick:()=>Ee(j),className:"text-red-600 hover:text-red-700 text-sm font-medium",disabled:ge.isPending,children:ge.isPending?"Deleting...":"Delete"}):e.jsx("button",{onClick:()=>ee(j),className:"text-green-600 hover:text-green-700 text-sm font-medium",disabled:me.isPending,children:me.isPending?"Restoring...":"Restore"})]})]},j.id))})]})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Add New Receipt"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Record a payment with automatic balance updates"})]}),e.jsx("button",{onClick:()=>{Fe(),a(!1)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ie,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"p-6 bg-blue-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ar,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Automatic Processing"}),e.jsx("p",{className:"text-sm text-blue-700",children:i==="TOMAN"?"Bank transfer receipts in TOMAN. Counterpart balances will be updated automatically.":"Cash transaction receipts in AED. Individual cash collection/payment tracking."})]})]})}),e.jsxs("form",{onSubmit:rt,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[e.jsx(tt,{className:"h-5 w-5 mr-2"}),"Receipt Type"]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{type:"button",onClick:()=>o("TOMAN"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg border-2 transition-all ${i==="TOMAN"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 bg-white text-gray-600 hover:border-gray-400"}`,children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${i==="TOMAN"?"bg-blue-500":"bg-gray-300"}`}),e.jsx("span",{className:"font-medium",children:"TOMAN Receipt"})]}),e.jsxs("button",{type:"button",onClick:()=>o("AED"),className:`flex items-center space-x-2 px-4 py-2 rounded-lg border-2 transition-all ${i==="AED"?"border-yellow-500 bg-yellow-50 text-yellow-700":"border-gray-300 bg-white text-gray-600 hover:border-gray-400"}`,children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${i==="AED"?"bg-yellow-500":"bg-gray-300"}`}),e.jsx("span",{className:"font-medium",children:"AED Receipt"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:i==="TOMAN"?"Bank transfer between trading party accounts":"Cash payment to/from individuals for AED transactions"})]}),i==="TOMAN"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(je,{className:"h-4 w-4 inline mr-1"}),"Who Paid? *"]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d.payer_id,onChange:j=>N({...d,payer_id:parseInt(j.target.value)}),required:!0,children:[e.jsx("option",{value:0,children:"Select the payer"}),(H||[]).map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(wt,{className:"h-4 w-4 inline mr-1"}),"Receiver Account *"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search by trading party or account number...",className:"w-full border border-gray-300 rounded-lg px-4 py-3 pr-10 focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:p,onChange:j=>{y(j.target.value),C(!0)},onFocus:()=>C(!0)}),e.jsx(st,{className:"h-4 w-4 absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]}),b&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:(()=>{const j=(Ne||[]).filter(q=>q.currency==="TOMAN").filter(q=>{const u=p.toLowerCase(),A=q.account_number.slice(-5);return(q.counterpart_name||"").toLowerCase().includes(u)||q.bank_name.toLowerCase().includes(u)||A.includes(u)||q.account_number.includes(u)});return j.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"No accounts found matching your search"}):j.map(q=>{const u=q.account_number.slice(-5);return e.jsx("button",{type:"button",className:`w-full text-left p-4 hover:bg-blue-50 border-b border-gray-100 last:border-b-0 transition-colors ${d.receiver_account_id===q.id?"bg-blue-50 border-blue-200":""}`,onClick:()=>{N({...d,receiver_account_id:q.id}),y(`${q.counterpart_name} - ${q.bank_name} (...${u})`),C(!1)},children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:q.counterpart_name}),e.jsx("div",{className:"text-sm text-gray-600",children:q.bank_name})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-mono text-gray-700 bg-gray-100 px-2 py-1 rounded",children:["...",u]}),e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:q.currency})]})]})},q.id)})})()}),b&&e.jsx("div",{className:"fixed inset-0 z-5",onClick:()=>C(!1)})]})]}),Se&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Selected Account Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Owner:"}),e.jsx("span",{className:"ml-2 font-medium",children:Se.counterpart_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Bank:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[Se.bank_name,e.jsxs("span",{className:"ml-1 font-mono text-xs bg-gray-100 px-1 py-0.5 rounded",children:["...",Se.account_number.slice(-5)]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Account:"}),e.jsx("span",{className:"ml-2 font-mono",children:Se.account_number})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Currency:"}),e.jsx("span",{className:"ml-2 font-medium",children:Se.currency})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(je,{className:"h-4 w-4 inline mr-1"}),"Receipt Type *"]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-yellow-500 focus:border-transparent",value:d.receipt_type,onChange:j=>N({...d,receipt_type:j.target.value}),required:!0,children:[e.jsx("option",{value:"pay",children:"Pay (Agrivex pays to individual)"}),e.jsx("option",{value:"receive",children:"Receive (Individual pays to Agrivex)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(je,{className:"h-4 w-4 inline mr-1"}),"Trading Party *"]}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-yellow-500 focus:border-transparent",value:d.trading_party_id,onChange:j=>N({...d,trading_party_id:parseInt(j.target.value)}),required:!0,children:[e.jsx("option",{value:0,children:"Select trading party"}),(H||[]).map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Vn,{className:"h-4 w-4 inline mr-1"}),"Individual Name *"]}),e.jsx("input",{type:"text",placeholder:"Name of person handling cash collection/payment",className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-yellow-500 focus:border-transparent",value:d.individual_name,onChange:j=>N({...d,individual_name:j.target.value}),required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Name of the individual who collected/paid cash"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(tt,{className:"h-4 w-4 inline mr-1"}),"Amount ",i==="AED"?"(AED)":"(TOMAN)"," *"]}),e.jsx("input",{type:"text",placeholder:i==="TOMAN"?"1,000,000":"1,000",className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d.amount,onChange:j=>{const q=j.target.value.replace(/,/g,"");/^\d*$/.test(q)&&N({...d,amount:q?parseInt(q).toLocaleString():""})},required:!0})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ds,{className:"h-4 w-4 inline mr-1"}),"Receipt Date *"]}),e.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:d.receipt_date,onChange:j=>N({...d,receipt_date:j.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(us,{className:"h-4 w-4 inline mr-1"}),"Notes (Optional)"]}),e.jsx("textarea",{placeholder:"Add any additional notes about this receipt...",className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3,value:d.notes,onChange:j=>N({...d,notes:j.target.value})})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>{Fe(),a(!1)},children:"Cancel"}),e.jsx("button",{type:"submit",className:`px-6 py-3 ${i==="TOMAN"?"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800":"bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800"} text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50`,disabled:Pe.isPending,children:Pe.isPending?"Creating...":`Create ${i} Receipt`})]})]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Receipt Details"}),e.jsx("button",{onClick:()=>l(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Ie,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[le(n.amount)," ",n.currency||"TOMAN"]}),e.jsx("div",{className:"text-sm text-green-700",children:n.currency==="AED"&&n.receipt_type==="pay"?"Amount Paid":"Amount Received"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Receipt ID:"}),e.jsxs("span",{className:"ml-2 font-medium",children:["#",n.id]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"ml-2 font-medium",children:new Date(n.receipt_date).toLocaleDateString()})]}),n.currency==="AED"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:n.receipt_type==="pay"?"Receiver:":"Payer:"}),e.jsx("span",{className:"ml-2 font-medium",children:n.trading_party_name||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:n.receipt_type==="pay"?"Payer:":"Receiver:"}),e.jsx("span",{className:"ml-2 font-medium",children:"Agrivex"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Individual:"}),e.jsx("span",{className:"ml-2 font-medium",children:n.individual_name||"Not specified"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Payer:"}),e.jsx("span",{className:"ml-2 font-medium",children:n.payer_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Receiver:"}),e.jsx("span",{className:"ml-2 font-medium",children:n.receiver_counterpart_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Bank:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[n.receiver_bank_name,n.receiver_account_number&&e.jsxs("span",{className:"ml-1 font-mono text-xs bg-gray-100 px-1 py-0.5 rounded",children:["...",n.receiver_account_number.slice(-5)]})]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:n.currency==="AED"?"Reference:":"Tracking:"}),e.jsxs("span",{className:"ml-2 font-mono",children:["...",n.tracking_last_5]})]})]}),n.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Notes:"}),e.jsx("p",{className:"mt-1 text-gray-900",children:n.notes})]})]}),e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:e.jsx("button",{onClick:()=>l(null),className:"w-full px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors",children:"Close"})})]})})}),x&&_&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-red-600",children:"Delete Receipt"}),e.jsx("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Ie,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-red-800 font-medium",children:" Warning: This action will reverse all accounting entries"}),e.jsxs("p",{className:"text-red-700 text-sm mt-1",children:["Receipt #",_.id," for ",_.amount.toLocaleString()," ",_.currency||"TOMAN"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for deletion"}),e.jsxs("select",{value:P,onChange:j=>z(j.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-red-500 focus:border-red-500",children:[e.jsx("option",{value:"duplicate",children:"Duplicate entry"}),e.jsx("option",{value:"funds_returned",children:"Funds were returned"}),e.jsx("option",{value:"receipt_not_landed",children:"Receipt did not land in account"}),e.jsx("option",{value:"data_error",children:"Data entry error"}),e.jsx("option",{value:"other",children:"Other reason"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Detailed explanation"}),e.jsx("textarea",{value:f,onChange:j=>D(j.target.value),placeholder:"Please provide specific details about why this receipt is being deleted...",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-red-500 focus:border-red-500 h-20 resize-none",required:!0})]})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3",children:[e.jsx("button",{onClick:()=>k(!1),className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:w,className:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50",disabled:ge.isPending||!f.trim(),children:ge.isPending?"Deleting...":"Delete Receipt"})]})]})}),K&&T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-green-600",children:"Restore Receipt"}),e.jsx("button",{onClick:()=>V(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Ie,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-green-800 font-medium",children:" This will restore all accounting entries"}),e.jsxs("p",{className:"text-green-700 text-sm mt-1",children:["Receipt #",T.id," for ",T.amount.toLocaleString()," ",T.currency||"TOMAN"]}),T.deletion_reason&&e.jsxs("p",{className:"text-green-700 text-sm mt-1",children:[e.jsx("strong",{children:"Originally deleted:"})," ",T.deletion_reason]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for restoration"}),e.jsx("textarea",{value:E,onChange:j=>R(j.target.value),placeholder:"Please explain why this receipt is being restored (e.g., payment was verified, funds landed in account, error was corrected)...",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-green-500 h-20 resize-none",required:!0})]})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3",children:[e.jsx("button",{onClick:()=>V(!1),className:"px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:X,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50",disabled:me.isPending||!E.trim(),children:me.isPending?"Restoring...":"Restore Receipt"})]})]})})]})}function Pl(){var f,D,P,z,F,M,K,V;const[s,t]=S.useState(""),[r,a]=S.useState(null),[n,l]=S.useState("TOMAN"),[i,o]=S.useState(!1),[h,m]=S.useState({startDate:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),{data:p}=ie({queryKey:["counterparts","balances"],queryFn:async()=>(await J.get("/counterparts/balances")).data.data}),{data:y}=ie({queryKey:["parties"],queryFn:async()=>(await J.get("/parties")).data.data}),{data:b}=ie({queryKey:["counterparts",r==null?void 0:r.id,"statement",n],queryFn:async()=>r?(await J.get(`/counterparts/${r.id}/statement?currency=${n}`)).data.data:null,enabled:!!r}),C=async()=>{if(r)try{const Q=(await J.get(`/counterparts/${r.id}/statement?currency=${n}&start_date=${h.startDate}&end_date=${h.endDate}&format=csv`,{responseType:"text"})).data,E=new Blob([Q],{type:"text/csv"}),R=URL.createObjectURL(E),I=document.createElement("a");I.href=R,I.download=`${r.name}_${n}_Statement_${h.startDate}_to_${h.endDate}.csv`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(R),o(!1)}catch(T){console.error("Export failed:",T),alert("Failed to export statement. Please try again.")}},d=async()=>{if(!(!r||!b))try{const Q=(await J.get(`/counterparts/${r.id}/statement?currency=${n}&start_date=${h.startDate}&end_date=${h.endDate}`)).data.data,E=Q.statement_lines||[],R=new za,I=R.internal.pageSize.width,Z=R.internal.pageSize.height,H=20,Ne=A=>{const G=new Date(A),ae=String(G.getDate()).padStart(2,"0"),ne=String(G.getMonth()+1).padStart(2,"0"),Le=String(G.getFullYear()).slice(-2);return`${ae}${ne}${Le}`},Pe=A=>A==="TOMAN"?"TMN":"AED",ge=Ne(h.startDate),me=Ne(h.endDate),Fe=Pe(n),rt=r.name.replace(/[^a-zA-Z0-9]/g,""),Ee=`${Fe}-${rt}-${ge}-${me}.pdf`,w=(A,G,ae)=>{A.setFontSize(10),A.setTextColor(100,100,100),A.text(`${G}/${ae}`,H,H-5),A.setFontSize(14),A.setFont("helvetica","bold"),A.text("ACCOUNT STATEMENT",I/2,H+5,{align:"center"}),A.setFontSize(12),A.setFont("helvetica","normal"),A.text(`Customer: ${r.name}`,H,H+20),A.text(`Currency: ${n}`,H,H+30);const ne=new Date(h.startDate).toLocaleDateString("en-GB"),Le=new Date(h.endDate).toLocaleDateString("en-GB");A.text(`Period: ${ne} to ${Le}`,H,H+40);let be=H+50;return r.phone&&(A.setFontSize(10),A.setTextColor(100,100,100),A.text(`Phone: ${r.phone}`,H,be),be+=10),r.email&&(A.setFontSize(10),A.setTextColor(100,100,100),A.text(`Email: ${r.email}`,H,be),be+=10),be+10},ee=E.sort((A,G)=>new Date(A.transaction_date).getTime()-new Date(G.transaction_date).getTime()).map(A=>{const G=new Date(A.transaction_date).toLocaleDateString("en-GB"),ae=A.description.replace(/Receipt from.*?for trade /gi,"Trade ").replace(/Payment for trade /gi,"Trade ").replace(/Trade obligation for trade /gi,"Trade ");return[G,A.transaction_type,ae,A.debit_amount>0?k(A.debit_amount):"",A.credit_amount>0?k(A.credit_amount):"",k(A.balance_after)]}),X=w(R,1,1),le=n==="TOMAN";Ha(R,{head:[["Date","Type","Description","Debit","Credit","Balance"]],body:ee,startY:X,theme:"grid",styles:{fontSize:le?8:9,cellPadding:3,overflow:"linebreak",halign:"left"},headStyles:{fillColor:n==="TOMAN"?[59,130,246]:[245,158,11],textColor:255,fontStyle:"bold",fontSize:le?9:10},columnStyles:{0:{cellWidth:le?22:25},1:{cellWidth:le?18:20},2:{cellWidth:le?60:70},3:{cellWidth:le?30:25,halign:"right"},4:{cellWidth:le?30:25,halign:"right"},5:{cellWidth:le?30:25,halign:"right",fontStyle:"bold"}},alternateRowStyles:{fillColor:[248,250,252]},margin:{left:H,right:H},tableWidth:"wrap",didDrawPage:function(){}});const at=E.reduce((A,G)=>A+G.debit_amount,0),Se=E.reduce((A,G)=>A+G.credit_amount,0),Nt=Q.current_balance,vt=R.lastAutoTable.finalY+20;vt+60>Z-H&&(R.addPage(),w(R,R.internal.getCurrentPageInfo().pageNumber,R.internal.getNumberOfPages()));const j=Math.max(vt,X);R.setFillColor(250,250,250),R.rect(H,j,I-2*H,50,"F"),R.setDrawColor(200,200,200),R.rect(H,j,I-2*H,50),R.setFontSize(12),R.setFont("helvetica","bold"),R.setTextColor(0,0,0),R.text("STATEMENT SUMMARY",H+10,j+15),R.setFontSize(10),R.setFont("helvetica","normal"),R.text(`Total Debits: ${k(at)} ${n}`,H+10,j+28),R.text(`Total Credits: ${k(Se)} ${n}`,H+10,j+38),R.setFont("helvetica","bold");const q=Nt>=0?[0,128,0]:[220,20,60];R.setTextColor(q[0],q[1],q[2]),R.text(`Final Balance: ${k(Nt)} ${n}`,H+10,j+48);const u=R.internal.getNumberOfPages();for(let A=1;A<=u;A++)R.setPage(A),R.setFillColor(255,255,255),R.rect(H-5,H-10,30,10,"F"),R.setFontSize(10),R.setTextColor(100,100,100),R.text(`${A}/${u}`,H,H-5);R.save(Ee),o(!1)}catch(T){console.error("PDF Export failed:",T),alert("Failed to export PDF. Please try again.")}},N=(y||[]).filter(T=>T.name.toLowerCase().includes(s.toLowerCase())),x=(p||[]).reduce((T,Q)=>(T[Q.counterpart_id]||(T[Q.counterpart_id]={counterpart_name:Q.counterpart_name,balances:{}}),T[Q.counterpart_id].balances[Q.currency]=Q.balance,T),{}),k=T=>T.toLocaleString(),_=T=>T>0?"text-success":T<0?"text-error":"text-base-content",v=T=>{switch(T){case"BUY":return e.jsx(gt,{className:"h-4 w-4 text-success"});case"SELL":return e.jsx(Kn,{className:"h-4 w-4 text-warning"});case"RECEIPT":return e.jsx(St,{className:"h-4 w-4 text-info"});default:return e.jsx(us,{className:"h-4 w-4"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Counterpart Statements"})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Select Counterpart"}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(st,{className:"h-4 w-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-base-content/50"}),e.jsx("input",{type:"text",placeholder:"Search counterparts...",className:"input input-bordered w-full pl-10",value:s,onChange:T=>t(T.target.value)})]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:N.map(T=>{var I;const Q=((I=x[T.id])==null?void 0:I.balances)||{},E=Q.AED||0,R=Q.TOMAN||0;return e.jsxs("div",{className:`p-3 border rounded cursor-pointer transition-colors ${(r==null?void 0:r.id)===T.id?"border-primary bg-primary/10":"border-base-300 hover:border-primary/50"}`,onClick:()=>a(T),children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(je,{className:"h-4 w-4 text-base-content/50"}),e.jsx("span",{className:"font-medium",children:T.name})]}),e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"AED:"}),e.jsx("span",{className:`font-mono ${_(E)}`,children:k(E)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"TOMAN:"}),e.jsx("span",{className:`font-mono ${_(R)}`,children:k(R)})]})]})]},T.id)})})]})})}),e.jsx("div",{className:"lg:col-span-2",children:r?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:r.name}),r.phone&&e.jsxs("p",{className:"text-base-content/70",children:["Phone: ",r.phone]}),r.email&&e.jsxs("p",{className:"text-base-content/70",children:["Email: ",r.email]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-base-200 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(tt,{className:"h-5 w-5 text-success"}),e.jsx("span",{className:"font-medium",children:"AED Balance"})]}),e.jsx("div",{className:`text-2xl font-bold font-mono ${_(((D=(f=x[r.id])==null?void 0:f.balances)==null?void 0:D.AED)||0)}`,children:k(((z=(P=x[r.id])==null?void 0:P.balances)==null?void 0:z.AED)||0)})]}),e.jsxs("div",{className:"bg-base-200 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(tt,{className:"h-5 w-5 text-warning"}),e.jsx("span",{className:"font-medium",children:"TOMAN Balance"})]}),e.jsx("div",{className:`text-2xl font-bold font-mono ${_(((M=(F=x[r.id])==null?void 0:F.balances)==null?void 0:M.TOMAN)||0)}`,children:k(((V=(K=x[r.id])==null?void 0:K.balances)==null?void 0:V.TOMAN)||0)})]})]})]})}),e.jsx("div",{className:"card bg-gradient-to-r from-blue-50 to-yellow-50 border-0",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Transaction Statement"}),e.jsxs("div",{className:"bg-white rounded-xl p-2 shadow-sm border border-gray-200 inline-flex",children:[e.jsxs("button",{onClick:()=>l("TOMAN"),className:`flex items-center space-x-3 px-6 py-3 rounded-lg transition-all duration-200 ${n==="TOMAN"?"bg-blue-500 text-white shadow-md transform scale-105":"text-gray-600 hover:text-blue-600 hover:bg-blue-50"}`,children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${n==="TOMAN"?"bg-white":"bg-gray-300"}`}),e.jsx("span",{className:"font-medium",children:"TOMAN Statement"}),n==="TOMAN"&&e.jsx("div",{className:"bg-white bg-opacity-20 px-2 py-1 rounded text-xs",children:"Active"})]}),e.jsxs("button",{onClick:()=>l("AED"),className:`flex items-center space-x-3 px-6 py-3 rounded-lg transition-all duration-200 ${n==="AED"?"bg-yellow-500 text-white shadow-md transform scale-105":"text-gray-600 hover:text-yellow-600 hover:bg-yellow-50"}`,children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${n==="AED"?"bg-white":"bg-gray-300"}`}),e.jsx("span",{className:"font-medium",children:"AED Statement"}),n==="AED"&&e.jsx("div",{className:"bg-white bg-opacity-20 px-2 py-1 rounded text-xs",children:"Active"})]})]})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs("button",{onClick:()=>o(!0),className:`flex items-center space-x-2 px-4 py-2 rounded-lg border-2 transition-all ${n==="TOMAN"?"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100":"border-yellow-200 bg-yellow-50 text-yellow-700 hover:bg-yellow-100"}`,disabled:!b||b.statement_lines.length===0,children:[e.jsx(ma,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Export Statement"})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:!b||b.statement_lines.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:`w-16 h-16 mx-auto mb-4 rounded-full flex items-center justify-center ${n==="TOMAN"?"bg-blue-100":"bg-yellow-100"}`,children:e.jsx(us,{className:`h-8 w-8 ${n==="TOMAN"?"text-blue-500":"text-yellow-500"}`})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No transactions found"}),e.jsxs("p",{className:"text-gray-600",children:["No ",n," transactions available for this counterpart"]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:`rounded-xl p-6 border-l-4 ${n==="TOMAN"?"bg-blue-50 border-blue-500":"bg-yellow-50 border-yellow-500"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Current Balance"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[n," Statement"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-3xl font-bold font-mono ${_(b.current_balance)}`,children:k(b.current_balance)}),e.jsx("div",{className:`text-sm font-medium ${n==="TOMAN"?"text-blue-600":"text-yellow-600"}`,children:n})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table table-zebra w-full",children:[e.jsx("thead",{className:"bg-base-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"Credit"}),e.jsx("th",{className:"px-4 py-3 text-right font-semibold",children:"Balance"})]})}),e.jsx("tbody",{children:b.statement_lines.map(T=>e.jsxs("tr",{className:"hover:bg-base-100",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:new Date(T.transaction_date).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[v(T.transaction_type),e.jsx("span",{className:"text-sm font-medium",children:T.transaction_type})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"text-sm leading-relaxed",children:[T.description,T.trade_number&&e.jsxs("div",{className:"text-xs text-base-content/60 mt-1",children:["Trade: ",T.trade_number]}),T.tracking_last_5&&e.jsxs("div",{className:"text-xs text-base-content/60 mt-1",children:["Tracking: ...",T.tracking_last_5]})]})}),e.jsx("td",{className:"px-4 py-3 text-right whitespace-nowrap",children:T.debit_amount>0?e.jsx("span",{className:"font-mono text-error font-medium",children:k(T.debit_amount)}):e.jsx("span",{className:"text-base-content/40",children:""})}),e.jsx("td",{className:"px-4 py-3 text-right whitespace-nowrap",children:T.credit_amount>0?e.jsx("span",{className:"font-mono text-success font-medium",children:k(T.credit_amount)}):e.jsx("span",{className:"text-base-content/40",children:""})}),e.jsx("td",{className:"px-4 py-3 text-right whitespace-nowrap",children:e.jsx("span",{className:`font-mono font-semibold ${_(T.balance_after)}`,children:k(T.balance_after)})})]},T.id))})]})})]})})})]}):e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body text-center py-12",children:[e.jsx(je,{className:"h-12 w-12 text-base-content/30 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-base-content/70 mb-2",children:"Select a Counterpart"}),e.jsx("p",{className:"text-base-content/50",children:"Choose a counterpart from the left to view their statement"})]})})})]}),i&&r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Export Statement"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[r.name," - ",n," Statement"]})]}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ds,{className:"h-4 w-4 inline mr-1"}),"Start Date"]}),e.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:h.startDate,onChange:T=>m({...h,startDate:T.target.value})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ds,{className:"h-4 w-4 inline mr-1"}),"End Date"]}),e.jsx("input",{type:"date",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:h.endDate,onChange:T=>m({...h,endDate:T.target.value})})]})]}),e.jsxs("div",{className:`p-4 rounded-lg border-l-4 ${n==="TOMAN"?"bg-blue-50 border-blue-500":"bg-yellow-50 border-yellow-500"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ht,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Export Summary"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("p",{children:[" Currency: ",n]}),e.jsxs("p",{children:[" Date Range: ",new Date(h.startDate).toLocaleDateString()," to ",new Date(h.endDate).toLocaleDateString()]}),e.jsx("p",{children:" Format: CSV (Excel compatible)"})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex space-x-3",children:[e.jsx("button",{onClick:()=>o(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:C,className:`flex-1 px-4 py-2 rounded-lg text-white font-medium transition-colors flex items-center justify-center space-x-2 ${n==="TOMAN"?"bg-blue-500 hover:bg-blue-600":"bg-yellow-500 hover:bg-yellow-600"}`,children:[e.jsx($n,{className:"h-4 w-4"}),e.jsx("span",{children:"CSV"})]}),e.jsxs("button",{onClick:d,className:"flex-1 px-4 py-2 rounded-lg text-white font-medium transition-colors flex items-center justify-center space-x-2 bg-gray-600 hover:bg-gray-700",children:[e.jsx(qn,{className:"h-4 w-4"}),e.jsx("span",{children:"PDF"})]})]})]})})]})}function Fl(){const[s,t]=S.useState(""),[r,a]=S.useState(""),[n,l]=S.useState(""),[i,o]=S.useState("entries"),{data:h,isLoading:m}=ie({queryKey:["journal-entries"],queryFn:()=>J.get("/journal/entries").then(f=>f.data.data)}),{data:p,isLoading:y}=ie({queryKey:["account-balances"],queryFn:()=>J.get("/journal/balances").then(f=>f.data.data)}),b=(f,D)=>new Intl.NumberFormat("en-US",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(f)+` ${D}`,C=(h==null?void 0:h.filter(f=>{var F;const D=f.entry_number.toLowerCase().includes(s.toLowerCase())||f.description.toLowerCase().includes(s.toLowerCase())||((F=f.trade_number)==null?void 0:F.toLowerCase().includes(s.toLowerCase())),P=!r||f.lines.some(M=>M.account_code.includes(r)||M.account_name.toLowerCase().includes(r.toLowerCase())),z=!n||f.lines.some(M=>M.currency===n);return D&&P&&z}))||[],d=(p==null?void 0:p.filter(f=>{const D=f.account_code.includes(s)||f.account_name.toLowerCase().includes(s.toLowerCase()),P=!n||f.currency===n;return D&&P}))||[];if(m||y)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})});const N=(h==null?void 0:h.length)||0,x=(p==null?void 0:p.filter(f=>f.currency==="AED"))||[],k=(p==null?void 0:p.filter(f=>f.currency==="TOMAN"))||[],_=x.filter(f=>f.account_type==="ASSET").reduce((f,D)=>f+D.balance,0),v=k.filter(f=>f.account_type==="ASSET").reduce((f,D)=>f+D.balance,0);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Journal & Accounting"})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{onClick:()=>o("entries"),className:`py-2 px-1 border-b-2 font-medium text-sm ${i==="entries"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(Hs,{className:"h-4 w-4 inline mr-2"}),"Journal Entries"]}),e.jsxs("button",{onClick:()=>o("balances"),className:`py-2 px-1 border-b-2 font-medium text-sm ${i==="balances"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(tt,{className:"h-4 w-4 inline mr-2"}),"Account Balances"]}),e.jsxs("button",{onClick:()=>o("counterparties"),className:`py-2 px-1 border-b-2 font-medium text-sm ${i==="counterparties"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(je,{className:"h-4 w-4 inline mr-2"}),"Counterparty Balances"]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(st,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:i==="entries"?"Search entries, descriptions, or trade numbers...":"Search accounts or counterparties...",className:"form-input pl-10",value:s,onChange:f=>t(f.target.value)})]})}),i==="entries"&&e.jsx("input",{type:"text",placeholder:"Account filter",className:"form-input w-40",value:r,onChange:f=>a(f.target.value)}),e.jsxs("select",{value:n,onChange:f=>l(f.target.value),className:"form-input w-32",children:[e.jsx("option",{value:"",children:"All Currencies"}),e.jsx("option",{value:"AED",children:"AED"}),e.jsx("option",{value:"TOMAN",children:"TOMAN"})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Hs,{className:"h-8 w-8 text-primary-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Total Entries"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:N})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(gt,{className:"h-8 w-8 text-success-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Assets (AED)"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:b(_,"AED")})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(gt,{className:"h-8 w-8 text-warning-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Assets (TOMAN)"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:b(v,"TOMAN")})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(je,{className:"h-8 w-8 text-primary-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Account Types"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:new Set(p==null?void 0:p.map(f=>f.account_type)).size})]})]})})})]}),i==="entries"&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Journal Entries"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Entry Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Debit"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credit"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),e.jsx("tbody",{className:"bg-white",children:C.map(f=>f.lines.map((D,P)=>e.jsxs("tr",{className:`${P===0?"border-t-2 border-primary-200":""} hover:bg-gray-50`,children:[P===0&&e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap border-r border-gray-200",rowSpan:f.lines.length,children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.entry_number}),e.jsx("div",{className:"text-sm text-gray-500 max-w-xs",children:f.description}),f.trade_number&&e.jsxs("div",{className:"text-xs text-primary-600 mt-1",children:["Trade: ",f.trade_number]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[D.account_code," - ",D.account_name]}),e.jsx("div",{className:"text-xs text-gray-500",children:D.currency})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:D.debit_amount>0?b(D.debit_amount,D.currency):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:D.credit_amount>0?b(D.credit_amount,D.currency):"-"}),P===0&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",rowSpan:f.lines.length,children:new Date(f.entry_date).toLocaleDateString()})]},`${f.id}-${D.id}`)))})]})})]}),i==="balances"&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Account Balances"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Currency"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(f=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[f.account_code," - ",f.account_name]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`badge ${f.account_type==="ASSET"?"badge-success":f.account_type==="LIABILITY"?"badge-danger":f.account_type==="EQUITY"?"badge-primary":f.account_type==="REVENUE"?"badge-success":"badge-warning"}`,children:f.account_type})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsx("span",{className:`badge ${f.currency==="AED"?"badge-success":"badge-warning"}`,children:f.currency})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("span",{className:`${f.balance<0?"text-red-600":"text-gray-900"}`,children:[b(Math.abs(f.balance),f.currency),f.balance<0?" (CR)":" (DR)"]})})]},`${f.account_code}-${f.currency}`))})]})})]}),i==="counterparties"&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Counterparty Balances"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(je,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Counterparty balance tracking coming soon..."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"This feature will show detailed balance tracking for each trading party"})]})})]})]})}const Ll=()=>{const[s,t]=S.useState(""),[r,a]=S.useState(""),[n,l]=S.useState(!1),[i,o]=S.useState(""),[h,m]=S.useState(!1),{login:p}=ps(),y=async b=>{b.preventDefault(),o(""),m(!0);try{await p(s,r)}catch(C){o(C instanceof Error?C.message:"Login failed")}finally{m(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-md w-full space-y-8",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"mx-auto h-12 w-12 bg-blue-600 rounded-xl flex items-center justify-center mb-4",children:e.jsx(In,{className:"h-6 w-6 text-white"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Sign in to Agrivex Trading System"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[i&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center space-x-3",children:[e.jsx(rr,{className:"h-5 w-5 text-red-500 flex-shrink-0"}),e.jsx("span",{className:"text-red-700 text-sm",children:i})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),e.jsx("input",{id:"username",type:"text",value:s,onChange:b=>t(b.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Enter your username",required:!0,autoComplete:"username",disabled:h})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"password",type:n?"text":"password",value:r,onChange:b=>a(b.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:h}),e.jsx("button",{type:"button",onClick:()=>l(!n),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors",disabled:h,children:n?e.jsx(as,{className:"h-5 w-5"}):e.jsx(Ct,{className:"h-5 w-5"})})]})]}),e.jsx("button",{type:"submit",disabled:h||!s||!r,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:h?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Signing in..."})]}):"Sign In"})]})]})})})},Ml=()=>{const{user:s}=ps(),[t,r]=S.useState([]),[a,n]=S.useState([]),[,l]=S.useState(!0),[i,o]=S.useState(!1),[h,m]=S.useState(!1),[p,y]=S.useState(null),[b,C]=S.useState("users"),[d,N]=S.useState(""),[x,k]=S.useState(""),[_,v]=S.useState({username:"",email:"",password:"",first_name:"",last_name:"",role:"regular"}),[f,D]=S.useState({password:"",confirmPassword:""}),[P,z]=S.useState({password:!1,confirmPassword:!1});S.useEffect(()=>{(s==null?void 0:s.role)==="superadmin"&&(F(),b==="activity"&&M())},[s,b]);const F=async()=>{try{const E=await fetch("/api/auth/users",{credentials:"include"});if(E.ok){const R=await E.json();r(R.data)}else throw new Error("Failed to fetch users")}catch{N("Failed to load users")}finally{l(!1)}},M=async()=>{try{const E=await fetch("/api/auth/activity-logs?limit=50",{credentials:"include"});if(E.ok){const R=await E.json();n(R.data)}else throw new Error("Failed to fetch activity logs")}catch{N("Failed to load activity logs")}},K=async E=>{E.preventDefault(),N("");try{console.log("Creating user with form data:",_);const R=await fetch("/api/auth/users",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(_)}),I=await R.json();if(console.log("Create user response:",{status:R.status,data:I}),R.ok)k("User created successfully"),o(!1),v({username:"",email:"",password:"",first_name:"",last_name:"",role:"regular"}),F();else if(I.details&&Array.isArray(I.details)){const Z=I.details.map(H=>H.msg).join(", ");throw new Error(`Validation failed: ${Z}`)}else throw new Error(I.error||"Failed to create user")}catch(R){console.error("Create user error:",R),N(R instanceof Error?R.message:"Failed to create user")}},V=async E=>{if(E.preventDefault(),N(""),f.password!==f.confirmPassword){N("Passwords do not match");return}if(p)try{const R=await fetch(`/api/auth/users/${p.id}/password`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:f.password})}),I=await R.json();if(R.ok)k("Password updated successfully"),m(!1),D({password:"",confirmPassword:""}),y(null);else throw new Error(I.error||"Failed to update password")}catch(R){N(R instanceof Error?R.message:"Failed to update password")}},T=async E=>{try{const R=await fetch(`/api/auth/users/${E.id}/toggle`,{method:"PUT",credentials:"include"}),I=await R.json();if(R.ok)k(`User ${E.is_active?"deactivated":"activated"} successfully`),F();else throw new Error(I.error||"Failed to toggle user status")}catch(R){N(R instanceof Error?R.message:"Failed to toggle user status")}},Q=E=>new Date(E).toLocaleString();return(s==null?void 0:s.role)!=="superadmin"?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ks,{className:"mx-auto h-12 w-12 text-red-500"}),e.jsx("h2",{className:"mt-4 text-xl font-semibold text-gray-900",children:"Access Denied"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"You need superadmin privileges to access this page."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx(je,{className:"mr-3 h-8 w-8 text-blue-600"}),"User Management"]}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Manage users, permissions, and monitor system activity"})]}),d&&e.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4 flex items-center",children:[e.jsx(rr,{className:"h-5 w-5 text-red-500 mr-3"}),e.jsx("span",{className:"text-red-700",children:d}),e.jsx("button",{onClick:()=>N(""),className:"ml-auto text-red-500 hover:text-red-700",children:""})]}),x&&e.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4 flex items-center",children:[e.jsx(ar,{className:"h-5 w-5 text-green-500 mr-3"}),e.jsx("span",{className:"text-green-700",children:x}),e.jsx("button",{onClick:()=>k(""),className:"ml-auto text-green-500 hover:text-green-700",children:""})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("nav",{className:"flex space-x-8",children:[e.jsxs("button",{onClick:()=>C("users"),className:`py-2 px-1 border-b-2 font-medium text-sm ${b==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(je,{className:"inline h-4 w-4 mr-2"}),"Users"]}),e.jsxs("button",{onClick:()=>C("activity"),className:`py-2 px-1 border-b-2 font-medium text-sm ${b==="activity"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(Pn,{className:"inline h-4 w-4 mr-2"}),"Activity Logs"]})]})}),b==="users"&&e.jsxs("div",{children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[e.jsx($t,{className:"h-4 w-4 mr-2"}),"Create New User"]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Login"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(E=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 bg-gray-300 rounded-full flex items-center justify-center",children:e.jsx(fs,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:E.first_name&&E.last_name?`${E.first_name} ${E.last_name}`:E.username}),e.jsxs("div",{className:"text-sm text-gray-500",children:["@",E.username]}),E.email&&e.jsx("div",{className:"text-sm text-gray-500",children:E.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${E.role==="superadmin"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:[E.role==="superadmin"&&e.jsx(Ks,{className:"h-3 w-3 mr-1"}),E.role]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${E.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E.last_login_at?e.jsxs("div",{className:"flex items-center",children:[e.jsx(ha,{className:"h-4 w-4 mr-1"}),Q(E.last_login_at)]}):"Never"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>{y(E),m(!0)},className:"text-blue-600 hover:text-blue-900",children:e.jsx(ir,{className:"h-4 w-4"})}),E.id!==(s==null?void 0:s.id)&&e.jsx("button",{onClick:()=>T(E),className:`${E.is_active?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"}`,children:e.jsx(xa,{className:"h-4 w-4"})})]})]},E.id))})]})})]}),b==="activity"&&e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Activity"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Timestamp"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(E=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Q(E.created_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:E.username}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded text-xs font-mono",children:E.action})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:E.details}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${E.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.success?"Success":"Failed"})})]},E.id))})]})})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Create New User"}),e.jsxs("form",{onSubmit:K,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username *"}),e.jsx("input",{type:"text",value:_.username,onChange:E=>v({..._,username:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:_.email,onChange:E=>v({..._,email:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),e.jsx("input",{type:"text",value:_.first_name,onChange:E=>v({..._,first_name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),e.jsx("input",{type:"text",value:_.last_name,onChange:E=>v({..._,last_name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:P.password?"text":"password",value:_.password,onChange:E=>v({..._,password:E.target.value}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:8}),e.jsx("button",{type:"button",onClick:()=>z({...P,password:!P.password}),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:P.password?e.jsx(as,{className:"h-4 w-4"}):e.jsx(Ct,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{value:_.role,onChange:E=>v({..._,role:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"regular",children:"Regular User"}),e.jsx("option",{value:"superadmin",children:"Super Admin"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Create User"})]})]})]})}),h&&p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Reset Password for ",p.username]}),e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:P.password?"text":"password",value:f.password,onChange:E=>D({...f,password:E.target.value}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:8}),e.jsx("button",{type:"button",onClick:()=>z({...P,password:!P.password}),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:P.password?e.jsx(as,{className:"h-4 w-4"}):e.jsx(Ct,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:P.confirmPassword?"text":"password",value:f.confirmPassword,onChange:E=>D({...f,confirmPassword:E.target.value}),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:8}),e.jsx("button",{type:"button",onClick:()=>z({...P,confirmPassword:!P.confirmPassword}),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:P.confirmPassword?e.jsx(as,{className:"h-4 w-4"}):e.jsx(Ct,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{m(!1),y(null),D({password:"",confirmPassword:""})},className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Update Password"})]})]})]})})]})};function ql(){const{isAuthenticated:s,isLoading:t}=ps();return t?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):s?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"flex",children:[e.jsx(Jn,{}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx(_l,{}),e.jsx("main",{className:"flex-1 p-6",children:e.jsxs(Ia,{children:[e.jsx(Me,{path:"/",element:e.jsx(Al,{})}),e.jsx(Me,{path:"/trades",element:e.jsx(El,{})}),e.jsx(Me,{path:"/positions",element:e.jsx(Tl,{})}),e.jsx(Me,{path:"/accounts",element:e.jsx(Dl,{})}),e.jsx(Me,{path:"/parties",element:e.jsx(Rl,{})}),e.jsx(Me,{path:"/receipts",element:e.jsx(Ol,{})}),e.jsx(Me,{path:"/counterparts",element:e.jsx(Pl,{})}),e.jsx(Me,{path:"/journal",element:e.jsx(Fl,{})}),e.jsx(Me,{path:"/users",element:e.jsx(Ml,{})})]})})]})]})}):e.jsx(Ll,{})}function $l(){return e.jsx(Dn,{children:e.jsx(ql,{})})}const Ul=new xn({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});Ds.createRoot(document.getElementById("root")).render(e.jsx(Ba.StrictMode,{children:e.jsx(Qa,{children:e.jsx(bn,{client:Ul,children:e.jsx($l,{})})})}));
